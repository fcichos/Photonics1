{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 1. General Optics\n",
    "\n",
    "(c) F. Cichos 2020"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Geometrical Optics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "tags": []
   },
   "outputs": [],
   "source": [
    "%matplotlib widget\n",
    "import ipywidgets as widgets\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Geometrical optics is based on the following assumptions of light propagation\n",
    "\n",
    "- light travels in form of rays, which are emitted by light sources and detected by detectors\n",
    "- the effect of a medium on the light propagation is described by the refractive index $n=c_{0}/c$\n",
    "- light takes time to travels a distance $d$ which is given by $t=d/c=nd/c_{0}$\n",
    "- $n d $ therefore amounts to the optical path length"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Law of reflection"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "| <center> <img src=\"reflection.png\" width=\"400\"/> </center> |\n",
    "|:-:|\n",
    "| **Figure 1:** Law of reflection |"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The law of reflection is the simplest one. It states, that the angle of incidence and the angle of reflection are always equal.\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_{1}=\\theta_{3}\n",
    "\\end{equation}\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Law of refraction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The law of refraction is known as Snell's law and relates the incident angle $\\theta_1$ with the angle of the refracted ray $\\theta_2$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "n_{1}\\sin(\\theta_{1})=n_{2}\\sin(\\theta_{2})\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "With this law of refraction, there are a number of special situations, that occur. This is for example the total internal refraction. You can explore different situations with the short program below which gives you control over the refractive indices and the incident angles. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "4a5d4c75cc1744cf9594fd89e73ce5f8",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "interactive(children=(FloatSlider(value=1.0, description='n1', max=2.0, min=1.0, step=0.01), FloatSlider(valueâ€¦"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "01323f133abe4a6b9d368c734ad6a362",
       "version_major": 2,
       "version_minor": 0
      },
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/OQEPoAAAACXBIWXMAAA9hAAAPYQGoP6dpAABBQElEQVR4nO3deVxU9f4/8NcsbC6AiDJCgLiiplIYRGW4UKaUkpbK9eaSuZReLcwUU9FK0Ral0sru72vmLRP1lrfMaxlabrhhIop77gq4xODGNvP5/TGXkyPbcJzhzAyv5+MxDw+f+Zw57w8485qzzGdUQggBIiKiGlIrXQARETkmBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBghZ1fHjx/Hkk0/Cy8sLKpUKa9euVbokAEC3bt3QrVs3pcuoVbNmzYJKpVK6DHJiDJA6atmyZVCpVNJNq9UiICAAw4cPx4ULF2Q/7rBhw5CVlYU5c+bgX//6F7p06WLFqquWnZ2NWbNm4fTp07W2zer8+uuvZr/nu28rV65UukQi2bRKF0DKeuuttxASEoLCwkLs3LkTy5Ytw7Zt23Dw4EG4u7vX6LFu376N9PR0vPnmmxg/fryNKq5cdnY2Zs+ejW7duqF58+Zm9/3888+1Xs+dJkyYgIceeqhce1RUlALVEFkHA6SO6927t7SX8NJLL8HX1xfz58/H999/j4EDB9bosS5fvgwA8Pb2rrbvzZs3Ub9+/RrXK5erq2utbasiXbt2xXPPPadoDfdCCIHCwkJ4eHjIfozS0lIYjUbF/xZkPTyERWa6du0KADh58qRZ+5EjR/Dcc8/Bx8cH7u7u6NKlC77//nvp/lmzZiE4OBgAMHnyZKhUKmkvoOxYfHZ2Nv72t7+hUaNGeOyxxwAABw4cwPDhw9GiRQu4u7tDp9PhxRdfxNWrV8vVduHCBYwcORL+/v5wc3NDSEgIXn75ZRQXF2PZsmV4/vnnAQDdu3eXDhH9+uuvACo+B5KXl4eRI0fCz88P7u7u6Ny5M7788kuzPqdPn4ZKpcL777+Pzz//HC1btoSbmxseeugh7NmzR94vuQJffPEFVCoVli5datY+d+5cqFQqrF+/vlw9CxcuRHBwMDw8PBAdHY2DBw9Wu53S0lK8/fbb0jiaN2+OadOmoaioyKxf8+bN8fTTT+Onn35Cly5d4OHhgSVLlgAA8vPz8eqrryIwMBBubm5o1aoV5s+fD6PRKK1/Z50pKSnS9rKzs+/1V0V2hHsgZKbs/EGjRo2ktkOHDuHRRx9FQEAApk6divr162PVqlWIi4vDv//9bzz77LPo378/vL298dprryE+Ph59+vRBgwYNzB77+eefR+vWrTF37lwIIQAAGzduxB9//IERI0ZAp9Ph0KFD+Pzzz3Ho0CHs3LlTOgl88eJFREREID8/H6NHj0ZoaCguXLiANWvW4NatW3j88ccxYcIEfPTRR5g2bRratWsHANK/d7t9+za6deuGEydOYPz48QgJCcHq1asxfPhw5OfnY+LEiWb9V6xYgevXr2PMmDFQqVR499130b9/f/zxxx9wcXGp9vd6/fp1XLlypVx748aNoVKpMGLECHz77bdISEjAE088gcDAQGRlZWH27NkYOXIk+vTpY7be8uXLcf36dYwbNw6FhYX48MMP0aNHD2RlZcHPz6/SOl566SV8+eWXeO655zBp0iTs2rULycnJOHz4ML777juzvkePHkV8fDzGjBmDUaNGoW3btrh16xaio6Nx4cIFjBkzBkFBQdixYwcSExNx6dIlpKSkmD3GF198gcLCQowePRpubm7w8fGp9ndFDkRQnfTFF18IAOKXX34Rly9fFufOnRNr1qwRTZo0EW5ubuLcuXNS3549e4qOHTuKwsJCqc1oNIpHHnlEtG7dWmo7deqUACDee+89s20lJSUJACI+Pr5cHbdu3SrX9s033wgAYsuWLVLb0KFDhVqtFnv27CnX32g0CiGEWL16tQAgNm/eXK5PdHS0iI6Oln5OSUkRAMRXX30ltRUXF4uoqCjRoEEDUVBQYDamxo0bi2vXrkl9//Of/wgA4ocffii3rTtt3rxZAKj0dunSJanvpUuXhI+Pj3jiiSdEUVGReOCBB0RQUJDQ6/VSn7J6PDw8xPnz56X2Xbt2CQDitddek9rKfu9l9u/fLwCIl156yazG119/XQAQmzZtktqCg4MFALFhwwazvm+//baoX7++OHbsmFn71KlThUaj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WpGZmSn69u0rQkJCxO3bt20+nrtZe3z5+fkiJiZGpKamiiNHjoj09HQREREhwsPDa3NYElv8/cp8++23onPnzsLf318sXLjQxiNxTAwQK8rOzhYAxJ49e6S2//73v0KlUokLFy5UuE5+fr5wcXERq1evltoOHz4sAIj09HSzvp988omIjo4WaWlpigSIrcd3p1deeUV0797desVXIiIiQowbN0762WAwCH9/f5GcnFxh/4EDB4rY2FiztsjISDFmzBghhBBGo1HodDrx3nvvSffn5+cLNzc38c0339hgBFWz9vgqsnv3bgFAnDlzxjpF14Ctxnf+/HkREBAgDh48KIKDgxkgleAhLCtKT0+Ht7c3unTpIrXFxMRArVZj165dFa6TkZGBkpISxMTESG2hoaEICgpCenq61JadnY233noLy5cvV2xiNVuO7256vR4+Pj7WK74CxcXFyMjIMKtNrVYjJiam0trS09PN+gNAr169pP6nTp1CTk6OWR8vLy9ERkZWOV5bsMX4KqLX66FSqeDt7W2Vui1lq/EZjUa88MILmDx5Mjp06GCb4p0EA8SKcnJy0LRpU7M2rVYLHx8f5OTkVLqOq6truSefn5+ftE5RURHi4+Px3nvvISgoyCa1W8JW47vbjh07kJqaitGjR1ul7spcuXIFBoMBfn5+FteWk5NTZf+yf2vymLZii/HdrbCwEFOmTEF8fHytT0xoq/HNnz8fWq0WEyZMsH7RToYBYoGpU6dCpVJVeTty5IjNtp+YmIh27drh73//u00eX+nx3engwYPo168fkpKS8OSTT9bKNkmekpISDBw4EEIIfPrpp0qXYxUZGRn48MMPsWzZMrv+agh74RTTudvapEmTMHz48Cr7tGjRAjqdDnl5eWbtpaWluHbtGnQ6XYXr6XQ6FBcXIz8/3+xdem5urrTOpk2bkJWVhTVr1gD46xvKfH198eabb2L27NkyR2ai9PjKZGdno2fPnhg9ejSmT58uayw14evrC41GU+6Kt4pqK6PT6arsX/Zvbm4umjVrZtYnLCzMitVXzxbjK1MWHmfOnMGmTZsUmRbdFuPbunUr8vLyzPb0DQYDJk2ahJSUFJw+fdq6g3B0Sp+EcSZlJ5n37t0rtf30008WnWRes2aN1HbkyBGzk8wnTpwQWVlZ0m3p0qUCgNixY0elV5vYgq3GJ4QQBw8eFE2bNhWTJ0+23QAqEBERIcaPHy/9bDAYREBAQJUnYZ9++mmztqioqHIn0d9//33pfr1er+hJdGuOTwghiouLRVxcnOjQoYPIy8uzTeEWsvb4rly5YvZcy8rKEv7+/mLKlCniyJEjthuIg2KAWNlTTz0lHnjgAbFr1y6xbds20bp1a7PLXM+fPy/atm0rdu3aJbWNHTtWBAUFiU2bNom9e/eKqKgoERUVVek2Nm/erOhlvNYeX1ZWlmjSpIn4+9//Li5duiTdauPFaeXKlcLNzU0sW7ZMZGdni9GjRwtvb2+Rk5MjhBDihRdeEFOnTpX6b9++XWi1WvH++++Lw4cPi6SkpAov4/X29hb/+c9/xIEDB0S/fv0UvYzXmuMrLi4Wffv2Fffdd5/Yv3+/2d+rqKjI4cdXEV6FVTkGiJVdvXpVxMfHiwYNGghPT08xYsQIcf36den+U6dOCQBi8+bNUtvt27fFK6+8Iho1aiTq1asnnn32WXHp0qVKt6FkgNhifElJSQJAuVtwcHCtjOnjjz8WQUFBwtXVVURERIidO3dK90VHR4thw4aZ9V+1apVo06aNcHV1FR06dBA//vij2f1Go1HMmDFD+Pn5CTc3N9GzZ09x9OjR2hhKhaw5vrK/b0W3O//mtcnaf7+7MUAqx+nciYhIFl6FRUREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGRhgBARkSwMECIikoUBQkREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGRhgBARkSwMECIikoUBQkREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGT5/1+ANaSMsgAiAAAAAElFTkSuQmCC",
      "text/html": [
       "\n",
       "            <div style=\"display: inline-block;\">\n",
       "                <div class=\"jupyter-widgets widget-label\" style=\"text-align: center;\">\n",
       "                    Figure\n",
       "                </div>\n",
       "                <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/OQEPoAAAACXBIWXMAAA9hAAAPYQGoP6dpAABBQElEQVR4nO3deVxU9f4/8NcsbC6AiDJCgLiiplIYRGW4UKaUkpbK9eaSuZReLcwUU9FK0Ral0sru72vmLRP1lrfMaxlabrhhIop77gq4xODGNvP5/TGXkyPbcJzhzAyv5+MxDw+f+Zw57w8485qzzGdUQggBIiKiGlIrXQARETkmBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBggREcnCACEiIlkYIEREJAsDhIiIZGGAEBGRLAwQIiKShQFCRESyMECIiEgWBghZ1fHjx/Hkk0/Cy8sLKpUKa9euVbokAEC3bt3QrVs3pcuoVbNmzYJKpVK6DHJiDJA6atmyZVCpVNJNq9UiICAAw4cPx4ULF2Q/7rBhw5CVlYU5c+bgX//6F7p06WLFqquWnZ2NWbNm4fTp07W2zer8+uuvZr/nu28rV65UukQi2bRKF0DKeuuttxASEoLCwkLs3LkTy5Ytw7Zt23Dw4EG4u7vX6LFu376N9PR0vPnmmxg/fryNKq5cdnY2Zs+ejW7duqF58+Zm9/3888+1Xs+dJkyYgIceeqhce1RUlALVEFkHA6SO6927t7SX8NJLL8HX1xfz58/H999/j4EDB9bosS5fvgwA8Pb2rrbvzZs3Ub9+/RrXK5erq2utbasiXbt2xXPPPadoDfdCCIHCwkJ4eHjIfozS0lIYjUbF/xZkPTyERWa6du0KADh58qRZ+5EjR/Dcc8/Bx8cH7u7u6NKlC77//nvp/lmzZiE4OBgAMHnyZKhUKmkvoOxYfHZ2Nv72t7+hUaNGeOyxxwAABw4cwPDhw9GiRQu4u7tDp9PhxRdfxNWrV8vVduHCBYwcORL+/v5wc3NDSEgIXn75ZRQXF2PZsmV4/vnnAQDdu3eXDhH9+uuvACo+B5KXl4eRI0fCz88P7u7u6Ny5M7788kuzPqdPn4ZKpcL777+Pzz//HC1btoSbmxseeugh7NmzR94vuQJffPEFVCoVli5datY+d+5cqFQqrF+/vlw9CxcuRHBwMDw8PBAdHY2DBw9Wu53S0lK8/fbb0jiaN2+OadOmoaioyKxf8+bN8fTTT+Onn35Cly5d4OHhgSVLlgAA8vPz8eqrryIwMBBubm5o1aoV5s+fD6PRKK1/Z50pKSnS9rKzs+/1V0V2hHsgZKbs/EGjRo2ktkOHDuHRRx9FQEAApk6divr162PVqlWIi4vDv//9bzz77LPo378/vL298dprryE+Ph59+vRBgwYNzB77+eefR+vWrTF37lwIIQAAGzduxB9//IERI0ZAp9Ph0KFD+Pzzz3Ho0CHs3LlTOgl88eJFREREID8/H6NHj0ZoaCguXLiANWvW4NatW3j88ccxYcIEfPTRR5g2bRratWsHANK/d7t9+za6deuGEydOYPz48QgJCcHq1asxfPhw5OfnY+LEiWb9V6xYgevXr2PMmDFQqVR499130b9/f/zxxx9wcXGp9vd6/fp1XLlypVx748aNoVKpMGLECHz77bdISEjAE088gcDAQGRlZWH27NkYOXIk+vTpY7be8uXLcf36dYwbNw6FhYX48MMP0aNHD2RlZcHPz6/SOl566SV8+eWXeO655zBp0iTs2rULycnJOHz4ML777juzvkePHkV8fDzGjBmDUaNGoW3btrh16xaio6Nx4cIFjBkzBkFBQdixYwcSExNx6dIlpKSkmD3GF198gcLCQowePRpubm7w8fGp9ndFDkRQnfTFF18IAOKXX34Rly9fFufOnRNr1qwRTZo0EW5ubuLcuXNS3549e4qOHTuKwsJCqc1oNIpHHnlEtG7dWmo7deqUACDee+89s20lJSUJACI+Pr5cHbdu3SrX9s033wgAYsuWLVLb0KFDhVqtFnv27CnX32g0CiGEWL16tQAgNm/eXK5PdHS0iI6Oln5OSUkRAMRXX30ltRUXF4uoqCjRoEEDUVBQYDamxo0bi2vXrkl9//Of/wgA4ocffii3rTtt3rxZAKj0dunSJanvpUuXhI+Pj3jiiSdEUVGReOCBB0RQUJDQ6/VSn7J6PDw8xPnz56X2Xbt2CQDitddek9rKfu9l9u/fLwCIl156yazG119/XQAQmzZtktqCg4MFALFhwwazvm+//baoX7++OHbsmFn71KlThUaj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WpGZmSn69u0rQkJCxO3bt20+nrtZe3z5+fkiJiZGpKamiiNHjoj09HQREREhwsPDa3NYElv8/cp8++23onPnzsLf318sXLjQxiNxTAwQK8rOzhYAxJ49e6S2//73v0KlUokLFy5UuE5+fr5wcXERq1evltoOHz4sAIj09HSzvp988omIjo4WaWlpigSIrcd3p1deeUV0797desVXIiIiQowbN0762WAwCH9/f5GcnFxh/4EDB4rY2FiztsjISDFmzBghhBBGo1HodDrx3nvvSffn5+cLNzc38c0339hgBFWz9vgqsnv3bgFAnDlzxjpF14Ctxnf+/HkREBAgDh48KIKDgxkgleAhLCtKT0+Ht7c3unTpIrXFxMRArVZj165dFa6TkZGBkpISxMTESG2hoaEICgpCenq61JadnY233noLy5cvV2xiNVuO7256vR4+Pj7WK74CxcXFyMjIMKtNrVYjJiam0trS09PN+gNAr169pP6nTp1CTk6OWR8vLy9ERkZWOV5bsMX4KqLX66FSqeDt7W2Vui1lq/EZjUa88MILmDx5Mjp06GCb4p0EA8SKcnJy0LRpU7M2rVYLHx8f5OTkVLqOq6truSefn5+ftE5RURHi4+Px3nvvISgoyCa1W8JW47vbjh07kJqaitGjR1ul7spcuXIFBoMBfn5+FteWk5NTZf+yf2vymLZii/HdrbCwEFOmTEF8fHytT0xoq/HNnz8fWq0WEyZMsH7RToYBYoGpU6dCpVJVeTty5IjNtp+YmIh27drh73//u00eX+nx3engwYPo168fkpKS8OSTT9bKNkmekpISDBw4EEIIfPrpp0qXYxUZGRn48MMPsWzZMrv+agh74RTTudvapEmTMHz48Cr7tGjRAjqdDnl5eWbtpaWluHbtGnQ6XYXr6XQ6FBcXIz8/3+xdem5urrTOpk2bkJWVhTVr1gD46xvKfH198eabb2L27NkyR2ai9PjKZGdno2fPnhg9ejSmT58uayw14evrC41GU+6Kt4pqK6PT6arsX/Zvbm4umjVrZtYnLCzMitVXzxbjK1MWHmfOnMGmTZsUmRbdFuPbunUr8vLyzPb0DQYDJk2ahJSUFJw+fdq6g3B0Sp+EcSZlJ5n37t0rtf30008WnWRes2aN1HbkyBGzk8wnTpwQWVlZ0m3p0qUCgNixY0elV5vYgq3GJ4QQBw8eFE2bNhWTJ0+23QAqEBERIcaPHy/9bDAYREBAQJUnYZ9++mmztqioqHIn0d9//33pfr1er+hJdGuOTwghiouLRVxcnOjQoYPIy8uzTeEWsvb4rly5YvZcy8rKEv7+/mLKlCniyJEjthuIg2KAWNlTTz0lHnjgAbFr1y6xbds20bp1a7PLXM+fPy/atm0rdu3aJbWNHTtWBAUFiU2bNom9e/eKqKgoERUVVek2Nm/erOhlvNYeX1ZWlmjSpIn4+9//Li5duiTdauPFaeXKlcLNzU0sW7ZMZGdni9GjRwtvb2+Rk5MjhBDihRdeEFOnTpX6b9++XWi1WvH++++Lw4cPi6SkpAov4/X29hb/+c9/xIEDB0S/fv0UvYzXmuMrLi4Wffv2Fffdd5/Yv3+/2d+rqKjI4cdXEV6FVTkGiJVdvXpVxMfHiwYNGghPT08xYsQIcf36den+U6dOCQBi8+bNUtvt27fFK6+8Iho1aiTq1asnnn32WXHp0qVKt6FkgNhifElJSQJAuVtwcHCtjOnjjz8WQUFBwtXVVURERIidO3dK90VHR4thw4aZ9V+1apVo06aNcHV1FR06dBA//vij2f1Go1HMmDFD+Pn5CTc3N9GzZ09x9OjR2hhKhaw5vrK/b0W3O//mtcnaf7+7MUAqx+nciYhIFl6FRUREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGRhgBARkSwMECIikoUBQkREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGRhgBARkSwMECIikoUBQkREsjBAiIhIFgYIERHJwgAhIiJZGCBERCQLA4SIiGT5/1+ANaSMsgAiAAAAAElFTkSuQmCC' width=400.0/>\n",
       "            </div>\n",
       "        "
      ],
      "text/plain": [
       "Canvas(header_visible=False, toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Bacâ€¦"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(figsize=(4, 4))\n",
    "fig.canvas.header_visible = False\n",
    " \n",
    "@widgets.interact(n1=(1,2,0.01),n2=(-2,3,0.01), angle=(0, 90, 0.1))\n",
    "def update(n1=1,n2=1.5,angle=45):\n",
    "    \"\"\"Remove old lines from plot and plot new one\"\"\"\n",
    "    ax.cla()\n",
    "    theta1=angle*np.pi/180\n",
    "    if n1*np.sin(theta1)/n2<=1:\n",
    "        theta2=np.arcsin(n1*np.sin(theta1)/n2)\n",
    "    else:\n",
    "        theta2=-theta1+np.pi\n",
    "    ax.set_title(\"Refraction Explorer\")    \n",
    "    ax.axvline(x=0,ls='--')\n",
    "    ax.text(-0.04,0.04,r'$n_2$={}'.format(n2))\n",
    "    ax.text(-0.04,-0.04,r'$n_1$={}'.format(n1))\n",
    "    ax.text(0.03,0.04,r'$\\theta_2$={}'.format(round(theta2*180/np.pi),1))\n",
    "    ax.text(0.03,-0.04,r'$\\theta_1$={}'.format(round(theta1*180/np.pi),1))\n",
    "\n",
    "\n",
    "    ax.axhline(y=0,color='k',lw=0.5)\n",
    "    ax.quiver(0,0,np.sin(theta1),np.cos(theta1),scale=3,pivot='tip' ,color='red')\n",
    "    ax.quiver(0,0,np.sin(theta2),np.cos(theta2),scale=3,color='blue')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": ""
    },
    "tags": []
   },
   "source": [
    "#### Refraction on spherical boundary"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Many of the interesting situations of refraction occur on interfaces, which are curved. Lenses, for example, have curved surfaces and the angles of refraction therefore change depending on the position. We can model in the simplest case by a spherical surface or in 2D just by a circular interface. The diagram below shows the definition of such a situation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}-\\theta_2+(\\pi-\\alpha)+\\delta=\\pi\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "-\\theta_2+\\pi-\\alpha+\\delta=\\pi\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\delta=\\alpha+\\theta_2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin(\\alpha)=\\frac y R,\\, \\tan(\\theta_2)=\\frac{y}{z_2},\\, \\tan(\\theta_1)=\\frac{y}{z_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "n_1\\sin(\\alpha+\\theta_1)=n_2\\sin(\\alpha+\\theta_2)\n",
    "\\end{equation}\n",
    "\n",
    "linearization: $\\sin(\\gamma)\\approx \\gamma$\n",
    "\n",
    "\\begin{equation}\n",
    "n_1(\\alpha+\\theta_1)=n_2(\\alpha+\\theta_2)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "n_1\\alpha+n_1\\theta_1=n_2\\alpha+n_2\\theta_2\n",
    "\\end{equation}\n",
    "\n",
    "\n",
    "\\begin{equation}\n",
    "n_2\\theta_2=(n_1-n_2)\\alpha+n_1\\theta_1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=-\\frac{n_2-n_1}{n_2}\\alpha+\\frac{n_1}{n_2}\\theta_1\n",
    "\\end{equation}\n",
    "\n",
    "replace angles by $y$\n",
    "\\begin{equation}\n",
    "\\theta_2\\approx \\frac{n_1}{n_2}\\theta_1-\\frac{n_2-n_1}{n_2R}y\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "conjugated planes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "\\frac{\\Delta y}{z_2}=\\frac{y}{z_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "(1)\\quad \\theta_1=0 \\quad \\Rightarrow \\quad \\theta_2^1=-\\frac{n_2-n_1}{n_2 R}y, \\quad \\tan \\theta_2=\\frac{\\Delta y+y}{z_2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "(2) \\quad \\theta_1=\\theta_2 \\quad n_2 \\theta_2^2=n_1\\theta_1^2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\Delta y+y}{z_2}=-\\frac{n_2-n_1}{n_2R}y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Delta y+y=-\\frac{n_2-n_1}{n_2R}yz_2, \\quad \\frac{\\Delta y}{z_2}=\\frac{y}{z_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "y\\left(\\frac{z_2}{z_1}+1\\right)=-\\frac{n_2-n_1}{n_2R}z_2y, \\quad \\Delta y=\\frac{y}{z_1}z_2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\left(\\frac{z_2}{z_1}+1\\right)=-\\frac{n_2-n_1}{n_2R}z_2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{1}{z_1}+\\frac{1}{z_2}=-\\frac{n_2-n_1}{n_2R}\n",
    "\\end{equation}\n",
    "\n",
    "independent of $y$ $\\Rightarrow$ all $y$ at $z_1$ end up in $z_2$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "conjugated planes means:\n",
    "- there is one point in $z_1$ which belongs to a point in $z_2$\n",
    "- foundation of image formation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "biconvex lens"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "apply the formula twice\n",
    "\\begin{equation}\n",
    "\\theta_2=\\frac{n_1}{n_2}\\theta_1-\\frac{n_2-n_1}{n_2R}y\n",
    "\\end{equation}\n",
    "first refraction, $n_1=1, n_2=n$\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_t=\\frac 1 n \\theta_1-\\frac{n-1}{nR_1}y\n",
    "\\end{equation}\n",
    "\n",
    "second refraction, $n_1=n, n_2=1$\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_t \\rightarrow \\theta_1, y \\rightarrow y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=\\frac n 1 \\theta_t-\\frac{1-n}{R_2}y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=\\frac n 1 \\left(\\frac 1 n \\theta_1-\\frac{n-1}{nR_1} y\\right)-\\frac{1-n}{R_2}y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=\\theta_1-\\frac{n-1}{R_1}y-\\frac{1-n}{R_2}y=\\theta_1-\\left(\\frac{n-1}{R_1}+\\frac{1-n}{R_2}\\right)y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{n-1}{R_1}+\\frac{1-n}{R_2}=(n-1)\\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right)=\\frac 1 f\n",
    "\\end{equation}\n",
    "\n",
    "lens maker equation, it tells what radii to use if you want to make a lens with $f$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "tags": []
   },
   "source": [
    "\\begin{equation}\n",
    "\\theta_2=\\theta_1-\\frac y f\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=\\frac{y}{z_2},\\quad \\theta_1=\\frac{y}{z_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{y}{z_2}=\\frac{y}{z_1}-\\frac y f \\quad \\Rightarrow \\quad \\frac{1}{z_1}+\\frac{1}{z_2}=\\frac 1 f\n",
    "\\end{equation}\n",
    "\n",
    "flipped the sign of one $z$ since it is going to the other direction\n",
    "\n",
    "$\\Rightarrow$ from the ??? rays\n",
    "\n",
    "\\begin{equation}\n",
    "y_2=-\\frac{z_2}{z_1}y_1\n",
    "\\end{equation}\n",
    "\n",
    "magnification\n",
    "\n",
    "two equations which can be used to ??? images of refractive optics in the limit of paraxial approximation\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin(x)\\approx x-\\frac{x^3}{6}+\\frac{x^5}{120}+ \\dots\n",
    "\\end{equation}\n",
    "\n",
    "that is\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{x^3}{6} \\ll x \\quad \\rm{or} \\quad \\frac{x^2}{6} \\ll 1 \\quad \\rm{or} \\quad x \\ll 0.4\\:\\:\\rm{in~radians}\n",
    "\\end{equation}\n",
    "\n",
    "this is not true for microscopy lenses, for example, there we have angles up to 80Â°, but it is then still a first oder approximation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The consequences of the violation of the paraxial approximation are imaging errors.\n",
    "\n",
    "Primary abberation classification by Seidel (1821â€“1896):\n",
    "- spherical abberation\n",
    "- coma\n",
    "- astigmatism\n",
    "- field curvature\n",
    "- distortion"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "third order approximation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "paraxial:\n",
    "\\begin{equation}\n",
    "\\frac{n_1}{z_1}+\\frac{n_2}{z_2}=\\frac{n_2-n_1}{R}\n",
    "\\end{equation}\n",
    "\n",
    "third order:\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{n_1}{z_1}+\\frac{n_2}{z_2}=\\frac{n_2-n_1}{R}+y^2\\left[\\frac{n_1}{2z_1}\\left(\\frac{1}{z_1}+\\frac 1 R\\right)^2+\\frac{n_2}{2 z_2}\\left(\\frac 1 R -\\frac{1}{z_2}\\right)^2\\right]\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Spherical Abberation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Coma"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Astigmatism"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Chromatic Abberation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "All of the measures to correct for abberations use different shaped objects or what is called nowadays adaptive optics, i.e., spatial light modulators."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Total internal reflection"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "n_1 \\sin(\\theta_1)=n_2\\sin(\\theta_2)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "n_2 < n_1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin(\\theta_1)=\\frac{n_2}{n_1}\\sin(\\theta_2)\n",
    "\\end{equation}\n",
    "\n",
    "$n_2/n_1 <1$\n",
    "\n",
    "but $\\theta_2$ is max. $\\pi/2$\n",
    "\n",
    "$\\sin (\\theta_2)$ should be larger than 1 \\\n",
    "$\\Rightarrow$ no solution for refraction \\\n",
    "$\\Rightarrow$ reflection for all incident angles $\\theta_1>\\theta_c$\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_c=\\sin^{-1}\\left|\\frac{n_2}{n_1}\\right|\n",
    "\\end{equation}\n",
    "\n",
    "for glass: 41.8Â° \\\n",
    "for water: 48.7Â° \\\n",
    "for diamond: 24Â° \\\n",
    "in H$_2$O: 33.6Â°"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$\\Rightarrow$ measurement of refraction indices \\\n",
    "$\\Rightarrow$ reflection without losses"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Guiding light fibers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- cylindrical dielectric wave guide\n",
    "- central core which guids light\n",
    "- cladding with lower $n$ than the core\n",
    "\n",
    "$\\Rightarrow$ total internal reflection\\\n",
    "$\\Rightarrow$ light guiding with low loss\n",
    "\n",
    "$\\Rightarrow$ typically reflected ??? waves:\n",
    "- multimode (???)\n",
    "- single mode\n",
    "- gradient index (???)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Step-index fiber"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "\\Delta=\\frac{n_1-n_2}{n_1}\n",
    "\\end{equation}\n",
    "\n",
    "mostly made of ??? silica $\\rm{SiO}_2$\\\n",
    "refractive indices from $1.44$ to $1.46$ \\\n",
    "$\\Delta=0.001$ and $0.02$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Meridional ray"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- all in plane\n",
    "- up to $\\overline \\theta_c=\\frac{\\pi}{2}-\\theta_c=\\cos^{-1}\\left(\\frac{n_2}{n_1}\\right)$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Skewed ray"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- planes ??? angle $\\phi$ with core cladding ??? $\\theta < \\overline \\theta_c$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Numerical aperture"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "calculation of the numerical aperture\n",
    "\\begin{equation}\n",
    "1 \\sin (\\theta_a)=n_1 \\sin \\overline \\theta_c = n_1 (1-\\cos^2(\\theta_c))^\\frac 1 2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_c+\\overline \\theta_c+\\frac \\pi 2 = \\pi\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_c+\\overline \\theta_c=\\frac \\pi 2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_c=\\frac \\pi 2 -\\overline \\theta_c\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "n_1 \\sin \\theta_c=n_2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin \\theta_c=\\frac{n_2}{n_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin \\left(\\frac \\pi 2 - \\overline \\theta_c \\right) =\\frac{n_2}{n_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\cos (\\overline \\theta_c)=\\frac{n_2}{n_1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sin (\\theta_a)=n_1\\left(1-\\frac{n_2^2}{n_1^2}\\right)^\\frac 1 2 =\\sqrt{n_1^2-n_2^2}=NA-n_1 (2 \\Delta)^\\frac 1 2\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Matrix Optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "both are linear equations\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=\\theta_1-\\frac 4 f \\qquad \\theta_2\\approx \\frac{n_1}{n_2}\\theta_1-\\frac{n_2-n_1}{n_2R}y\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "y_2=Ay_1+B\\theta_1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_2=Cy_1+D\\theta_1\n",
    "\\end{equation}\n",
    "\n",
    "We want to express an optical system by a set of simple mathematical expressions, i.e., linear projections.\n",
    "\n",
    "\\begin{equation}\n",
    "\\left[\\begin{array}{r}\n",
    "y_2 \\\\\n",
    "\\theta_2\n",
    "\\end{array}\\right]=\n",
    "\\left[\\begin{array}{rr}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{array}\\right]\n",
    "\\left[\\begin{array}{r}\n",
    "y_1 \\\\\n",
    "\\theta_1\n",
    "\\end{array}\\right]\n",
    "\\end{equation}\n",
    "\n",
    "Here,\n",
    "$\n",
    "\\begin{bmatrix}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{bmatrix}\n",
    "$\n",
    "is the ray transfer matrix."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Free space"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Refraction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "0 & \\frac{n_1}{n_2}\n",
    "\\end{bmatrix}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Spherical surface"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{n_2-n_1}{n_2R} & \\frac{n_1}{n_2}\n",
    "\\end{bmatrix}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Thin Lens"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "$f>0$ convex \\\n",
    "$f<0$ concave\n",
    "\n",
    "There is a whole set of precalculated matrices for optical elements."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Optical systems"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$M=M_NM_{N-1}\\dots M_1$ (remember the two curved surfaces)\n",
    "\n",
    "free space\n",
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "thin lens\n",
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "M=\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}=\n",
    "\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "-\\frac 1 f & 1- \\frac d f\n",
    "\\end{bmatrix}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## For example: Optical cloaking"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "perfect cloack is an optical system which apparently immitates free space propagation\n",
    "\n",
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & \\frac L n \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "cloacking condition\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{bmatrix}=\n",
    "\\begin{bmatrix}\n",
    "1 & \\frac L n \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "$C=0 \\quad$  no ??? power, afocal\n",
    "\n",
    "#### single lens\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{bmatrix}=\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "not possible except for $f=\\pm \\infty \\Rightarrow $ no cloaking\n",
    "\n",
    "#### two lenses\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_2} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_1} & 1\n",
    "\\end{bmatrix}=\n",
    "\\begin{bmatrix}\n",
    "1-\\frac{t}{f_1} & t \\\\\n",
    "-\\frac{f_1+f_2-t}{f_1f_2} & 1-\\frac{t}{f_2}\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ needs $f_1=f_2=\\pm \\infty$\n",
    "\n",
    "$1-\\frac{t}{f_1}=1,~ 1-\\frac{t}{f_2}=1$\n",
    "\n",
    "#### three lenses\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_3} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t_2 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_2} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t_1 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_1} & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "\n",
    "\\begin{equation}\n",
    "C=0:\\quad \n",
    "f_2=-\\frac{(f_1-t_1)(f_3-t_2)}{f_1+f_3-t_1-t_2}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ matrix, four lens system\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "\\frac{f_3(f_1-t_1)}{f_1(f_3-t_2)} & t_1+t_2+t_1t_2\\frac{f_1+f_3-t_1-t_2}{(f_1-t_1)(f_3-t_2)}\\\\\n",
    "0 & \\frac{f_1 (f_3-t_2)}{f_3 (f_1-t_1)}\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "from $B=t_1+t_2$\n",
    "\n",
    "\\begin{equation}\n",
    "t_1t_2\\frac{f_1+f_3-t_1-t_2}{(f_1-t_1)(f_3-t_2)}=0\n",
    "\\end{equation}\n",
    "\n",
    "a) this in only true if $t_1=0$ or $t_2=0$\\\n",
    "b) or if $f_1+f_3-t_1-t_2=0$\n",
    "\n",
    "a) $\\Rightarrow$ two lens system $\\Rightarrow$ no cloaking \\\n",
    "b) follows that $f_2 \\rightarrow \\infty$ $\\Rightarrow$ two lens $\\Rightarrow$ no cloaking \n",
    "\n",
    "$\\Rightarrow$ three lens, no cloaking\n",
    "\n",
    "#### four lens system\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "1 & t_4 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_4} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t_3 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_3} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t_2 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_2} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & t_1 \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac{1}{f_1} & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "with conditions $f_1=f_4, f_2=f_3, t_1=t_3$ \\\n",
    "require that $A=1, C=0$\n",
    "with $t_1=f_1+f_2$\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "1 & f_1(-2t_1^2+f_1(2t_1+t_2))/(f_1-t_1)^2)\\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "$B=2t_1+t_2$\n",
    "\\begin{equation}\n",
    "t_2=2f_2 \\frac{f_1+f_2}{f_1-f_2}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Fermat's Principle"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- optical inhomogeneous material $n(\\vec r)$, $\\vec r= \\{x, y, z\\}$\n",
    "- optical path length\n",
    "\\begin{equation}\n",
    "OP=\\int_A^B n(\\vec r) \\mathrm ds\n",
    "\\end{equation}\n",
    "- time taken to get from $A$ to $B$ is proportonal to $OP$ length\n",
    "\n",
    "Fermat's principle: optical path length is an extremum to neighboring path\n",
    "\n",
    "\\begin{equation}\n",
    "\\delta \\int_A^B n(\\vec r)\\mathrm d s=0\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ minimum, maximum, point of inflection \\\n",
    "usually minimum\n",
    "\n",
    "point of inflection"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Refraction\n",
    "\n",
    "\\begin{equation}\n",
    "A=\\begin{pmatrix}\n",
    "0 \\\\ z_1\n",
    "\\end{pmatrix}, \\quad\n",
    "B= \\begin{pmatrix}\n",
    "y_2 \\\\ z_2\n",
    "\\end{pmatrix}, \\quad\n",
    "R=\\begin{pmatrix}\n",
    "y_0 \\\\ 0\n",
    "\\end{pmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "OPL=n_1 \\sqrt{y_0^2+z_1^2}+n_2\\sqrt{(y_2-y_0)^2+z_2^2}\n",
    "\\end{equation}\n",
    "\n",
    "Fermat:\n",
    "\\begin{equation}\n",
    "\\begin{split}\n",
    "\\frac{\\mathrm d (OPL)}{\\mathrm d y_0}&=n_1\\frac{y_0}{\\sqrt{y_0^2+z_1^2}}-n_2\\frac{y_2-y_0}{\\sqrt{(y_2-y_0)^2+z_2^2}}=0\\\\\n",
    "&= n_1 \\frac{y_0}{l_1}-n_2 \\frac{y_2-y_0}{l_2}\\\\\n",
    "&= n_1 \\sin (\\alpha) - n_2 \\sin (\\beta)\n",
    "\\end{split}\n",
    "\\end{equation}\n",
    "\n",
    "This is Snell's law."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Thin lens\n",
    "\n",
    "$n \\dots$ refraction index of lens \\\n",
    "$R_1, R_2 \\dots$ curvature\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{split}\n",
    "OPL&= z_1(y)+n(d-z_1(y)-z_2(y))+z_2(y)+\\sqrt{f^2+y^2}\\\\\n",
    "&\\equiv nd+f-(n-1)\\left(\\frac{y^2}{2 R_1}-\\frac{y^2}{2R_2}\\right)+\\frac{y^2}{2f}\n",
    "\\end{split}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ all OPL must be the same if the rays converge at f\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d (OPL)}{\\mathrm d y}=-(n-1)\\left(\\frac{y}{R_1}-\\frac{y}{R_2} \\right)+\\frac y f =0\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Formulation of Fermat's principle\n",
    "\n",
    "integral (global)\n",
    "\\begin{equation}\n",
    "\\delta \\int_A^B n(\\vec{r})\\,\\mathrm ds=0\n",
    "\\end{equation}\n",
    "\n",
    "differential (local)\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d}{\\mathrm ds}\\left(n\\frac{\\mathrm d (\\vec{r})}{\\mathrm ds}\\right)=\\nabla n\n",
    "\\end{equation}\n",
    "\n",
    "if the trajectory is described by $x(s), y(s), z(s)$ ??? variational calculus."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Differential form in components\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d}{\\mathrm ds}\\left(n \\frac{\\mathrm dx}{\\mathrm ds}\\right)=\\frac{\\partial n}{\\partial x} \\qquad \\frac{\\mathrm d}{\\mathrm ds}\\left(n \\frac{\\mathrm dy}{\\mathrm ds}\\right)=\\frac{\\partial n}{\\partial y} \\qquad \\frac{\\mathrm d}{\\mathrm ds}\\left(n \\frac{\\mathrm dz}{\\mathrm ds}\\right)=\\frac{\\partial n}{\\partial z}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "x(s) \\hspace{3.9cm} y(s) \\hspace{3.9cm} z(s)\n",
    "\\end{equation}\n",
    "\n",
    "difficult to solve but possible with parametrization\n",
    "\n",
    "\\begin{equation}\n",
    "x=x(z),\\quad y=y(z), \\quad \\mathrm ds = \\mathrm dz  \\sqrt{1+\\left(\\frac{\\mathrm dx}{\\mathrm dz}\\right)^2+\\left(\\frac{\\mathrm dy}{\\mathrm dz}\\right)^2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\mathrm ds \\approx \\mathrm dz\n",
    "\\end{equation}\n",
    "\n",
    "paraxial approximation:\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\frac{\\mathrm d}{\\mathrm dz}\\left(n\\frac{\\mathrm dx}{\\mathrm dz}\\right) \\approx \\frac{\\partial n}{\\partial x} \\qquad \\frac{\\mathrm d}{\\mathrm dz}\\left(n \\frac{\\mathrm dy}{\\mathrm dz}\\right)\\approx \\frac{\\partial n}{\\partial y}\n",
    "\\end{equation}\n",
    "\n",
    "homogeneous medium:\n",
    "\\begin{equation}\n",
    "n={\\rm const.} \\quad \\Rightarrow \\quad \\frac{\\mathrm d^2 x}{\\mathrm dz^2}=\\frac{\\mathrm d^2 y}{\\mathrm dz^2}=0 \\quad {\\rm straight~line}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### GRIN lens"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "graded index lens\n",
    "\n",
    "SELFOC\n",
    "\\begin{equation}\n",
    "n^2(y)=n_0^2(1-\\alpha^2y^2)\n",
    "\\end{equation}\n",
    "\n",
    "for $\\alpha^2y^2 \\ll 1$: parabolic index profile\n",
    "\\begin{equation}\n",
    "n(y)\\approx n_0 \\left(1-\\frac 1 2 \\alpha^2y^2\\right)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d^2y}{\\mathrm dz^2}\\approx -\\alpha^2y=\\frac{\\partial n}{\\partial y}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "y(z)=y_0 \\cos(\\alpha z)+\\frac{\\theta_0}{\\alpha}\\sin(\\alpha z)\n",
    "\\end{equation}\n",
    "The refractive index square is like a potential."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### What you should know:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- How to create a magnifying optical system?\n",
    "- What are the simplifying assumptions behind the imaging equations for a thin lens?\n",
    "- What are virtual images and real images?\n",
    "- How to construct an image of a lens or a lens system?\n",
    "- How to detect the direction from which light is coming?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Mirage effect over a hot street"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "approximation\n",
    "\\begin{equation}\n",
    "n(y)=n_0+\\alpha y \\quad{\\rm (approximately~linear)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d^2x}{\\mathrm da^2}=0, \\quad \\frac{\\mathrm d^2 y}{\\mathrm da^2}=\\frac{1}{2}\\nabla n^2=\\alpha(n_0+\\alpha y)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow x=Aa+B\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow y=C \\cosh(\\alpha a)+D \\sinh(\\alpha a)-\\left(\\frac{n_0}{a}\\right)\n",
    "\\end{equation}\n",
    "\n",
    "let $a=0$ at $x=0$ (like $t=0$ in mechanics)\n",
    "\n",
    "at $x_{a=0}=0$, $y_{a=0}=h$\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow B=0, \\quad C=h+\\frac{n_0}{\\alpha}\n",
    "\\end{equation}\n",
    "\n",
    "same now checked with $\\frac{\\mathrm d \\vec{r}}{\\mathrm da}=n$ (corresponds to velocity)\n",
    "at $x=0$ horizontal\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\frac{\\mathrm dx}{\\mathrm da}=n_h=n_0+\\alpha h, \\quad \\frac{\\mathrm dy}{\\mathrm da}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow A=n_h, \\quad D=0\n",
    "\\end{equation}\n",
    "\n",
    "solution: ?\n",
    "\\begin{equation}\n",
    "x=(n_0+\\alpha h)a\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "y=\\left(\\frac{n_0}{\\alpha}+h\\right)\\cosh(\\alpha a)-\\frac{n_0}{\\alpha}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ${\\bf F = m \\cdot a}$ optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Newton's law\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d^2 \\vec{r}}{\\mathrm dt^2}=-\\nabla U(\\vec{r}), \\quad m=1\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Fermat's principle\n",
    "\\begin{equation}\n",
    "\\frac{\\mathrm d^2 \\vec{r}}{\\mathrm ds^2}=\\nabla\\left(\\frac 1 2 n^2(\\vec{r}) \\right)\n",
    "\\end{equation}\n",
    "\n",
    "side condition:\n",
    "\\begin{equation}\n",
    "\\left|\\frac{\\mathrm d \\vec{r}}{\\mathrm ds} \\right|=n\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=\\frac 1 2 n^2 (\\vec{r})\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Corresponding quantities\n",
    "\n",
    "\\begin{array}{c|c|c}\n",
    "\\rm quantity & \\rm mechanics & \\rm optics \\\\\n",
    "\\hline\n",
    "\\rm position & r(t) & r(a)\\\\\n",
    "\\hline\n",
    "\\rm time & t & a \\\\\n",
    "\\hline\n",
    "\\rm velocity & \\frac{\\mathrm dr}{\\mathrm dt} & \\frac{\\mathrm dr}{da} \\\\\n",
    "\\hline\n",
    "\\rm potential~energy & U(r) & -\\frac{n^2 (r)}{2} \\\\\n",
    "\\hline\n",
    "\\rm mass & m & 1 \\\\\n",
    "\\hline\n",
    "\\rm kinetic~energy & \\frac{m}{2}\\left(\\frac{\\mathrm dr}{\\mathrm dt} \\right)^2 & \\frac{1}{2}\\left|\\frac{\\mathrm dr}{\\mathrm da} \\right|^2 \\\\\n",
    "\\hline\n",
    "\\rm total~energy & \\frac{m}{2}\\left(\\frac{\\mathrm dr}{\\mathrm dt} \\right)^2+U & \\frac{1}{2}\\left|\\frac{\\mathrm dr}{\\mathrm da} \\right|^2-\\frac{n^2}{2}=0\n",
    "\\end{array}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Example:\n",
    "\n",
    "Coulomb potential:\n",
    "\\begin{equation}\n",
    "U(r)=\\frac{Q}{4 \\pi \\epsilon_0 r}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "r_{\\rm RF}(\\phi)=\\frac{(2 E/k)b^2}{e \\cos(\\phi-\\chi)-1}\n",
    "\\end{equation}\n",
    "\n",
    "photonic potential:\n",
    "\\begin{equation}\n",
    "U(r)=-\\frac{n_0^2}{2}\\left(1+\\frac{2 \\Delta n R}{n_0 r}+ \\dots \\right)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "r_{\\rm PRF}(\\phi)\\approx \\frac{|\\zeta|b^2}{\\sqrt{b^2\\zeta^2+1}\\cos(\\phi-\\chi)-1}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ray optics and momentum"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- momentum of a photon in a ray $\\vec{p}=\\hbar \\vec{k}, \\vec{k}=\\frac{2 \\pi}{\\lambda}\\vec{e}_k$\n",
    "- direction and wavelength changes\n",
    "- reflection and refraction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Optical Tweezers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Wave Optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### postulates:\n",
    "- light travels in form of rays\n",
    "- optical medium characterized by $n$\n",
    "\\begin{equation}\n",
    "c=\\frac{c_0}{n}\n",
    "\\end{equation}\n",
    "- optical waves satisfy wave equation\n",
    "\\begin{equation}\n",
    "\\nabla^2u-\\frac{1}{c^2}\\frac{\\partial^2 u}{\\partial t^2}=0\n",
    "\\end{equation}\n",
    "\n",
    "$\\qquad \\Rightarrow$ linear differential equation\\\n",
    "$\\qquad$ superposition: $u_1$ and $u_2$ solutions $\\Rightarrow a_1u_1+a_2u_2$ also solution"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### optical intensity\n",
    "\\begin{equation}\n",
    "I(r,t)=2\\langle u^2(r,t)\\rangle\n",
    "\\end{equation}\n",
    "\n",
    "averaged over times larger than one optical cycle $10^{-15}$ s for $600$ nm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### optical power\n",
    "\\begin{equation}\n",
    "P(t)=\\int_A I(r,t)\\, \\mathrm dA\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "u(\\vec{r},t)=a(\\vec{r})\\cdot\\cos(\\omega t+\\phi (\\vec{r}))\n",
    "\\end{equation}\n",
    "\n",
    "$a(\\vec{r})$: amplitude\\\n",
    "$\\omega$: frequency, $\\omega=2 \\pi \\nu =\\frac{2 \\pi}{T}$\\\n",
    "$\\phi (\\vec{r})$: phase\n",
    "\n",
    "useful:\n",
    "\\begin{equation}\n",
    "u(\\vec{r},t)=a(\\vec{r})\\,e^{i \\phi (\\vec{r})}\\,e^{i \\omega t}=U(\\vec{r})\\,e^{i \\omega t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "u(\\vec{r},t)=Re\\{U(\\vec{r},t)\\}=\\frac 1 2 \\left(U(\\vec{r},t)+U^*(\\vec{r},t)\\right)\n",
    "\\end{equation}\n",
    "\n",
    "has to satisfy\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla^2 u - \\frac{1}{c^2}\\frac{\\partial^2 u}{\\partial t^2}=0\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ Helmholtz equation\n",
    "\\begin{equation}\n",
    "(\\nabla^2+k^2) U(\\vec{r})=0\n",
    "\\end{equation}\n",
    "\n",
    "$k=\\frac{\\omega}{c}$: wave number\\\n",
    "$|U(\\vec{r})|$: amplitude, $I(\\vec{r})=|U(\\vec{r})|^2$\\\n",
    "$\\arg\\{u(\\vec{r})\\}$: phase, $\\phi(r)={\\rm const}$ wavefront"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### elementary types of waves\n",
    "\n",
    "spherical:\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=\\frac{A e^{-ikr}}{|\\vec{r}|}\\quad {\\rm outwards}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=\\frac{A e^{ikr}}{|\\vec{r}|}\\quad {\\rm inwards}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I=\\frac{|A|^2}{r^2}, \\quad r \\to |\\vec{r}-\\vec{r}_0|~{\\rm for~origin~at}~\\vec{r}_0\n",
    "\\end{equation}\n",
    "\n",
    "Fresnel Approximation\n",
    "\n",
    "origin $\\vec{r}=0$ ?? look close to z-axis with $(x^2+y^2)^{\\frac{1}{2}} \\ll z$ (paraxial) with $\\theta^2=(x^2+y^2)/z^2 \\ll 1$\n",
    "\n",
    "Taylor\n",
    "\\begin{align}\n",
    "r&=\\sqrt{x^2+y^2+z^2}=z (1+\\theta^2)^{\\frac 1 2}=z\\left(1+\\frac{\\theta^2}{2}+\\frac{\\theta^4}{8}+\\dots\\right)\\\\\n",
    "&\\approx z\\left(1+\\frac{\\theta^2}{2}\\right)=z+\\frac{x^2+y^2}{2z}\n",
    "\\end{align}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow U(r)=\\frac{A}{z}\\,e^{-ikz}\\,e^{\\left(-ik \\frac{x^2+y^2}{2z}\\right)}\\quad{\\rm Fresnel~approximation}\n",
    "\\end{equation}\n",
    "\n",
    "condition\n",
    "\\begin{equation}\n",
    "kz \\frac{\\theta^4}{8}\\ll \\pi \\quad {\\rm or} \\quad (x^2+y^2)^2\\ll 4z^3\\lambda,~ a^4 \\ll 4 z^3 \\lambda\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{N_F \\theta^2_m}{4} \\ll 1, \\quad \\theta_m=\\frac a z \n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "N_F=\\frac{a^2}{\\lambda z} \\quad {\\rm Fresnel~number}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ plane waves\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=A e^{-i \\vec{k}\\vec{r}}, \\quad \\vec{k} \\dots {\\rm wavevector}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "u(\\vec{r},t)=A e^{i(\\omega t - \\vec{k}\\vec{r})}, \\quad A \\dots {\\rm complex~amplitude}\n",
    "\\end{equation}\n",
    "\n",
    "phase: $2\\pi m, m \\in N $\n",
    "\n",
    "\\begin{equation}\n",
    "\\omega t - \\vec{k}\\vec{r}=2 \\pi m,~m=1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\omega-\\vec{k}\\frac{\\mathrm d \\vec{r}}{\\mathrm dt}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{k}\\omega-k^2\\frac{\\mathrm d \\vec{r}}{\\mathrm dt}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "k^2\\frac{\\mathrm d \\vec{r}}{\\mathrm dt}=\\vec{k} \\omega\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\frac{\\mathrm d \\vec{r}}{\\mathrm dt}=\\frac{\\vec k}{k^2}\\omega=\\frac{\\omega}{k}\\vec{e}_k\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "|\\vec{k}|=\\frac{2 \\pi}{\\lambda},~\\frac{\\omega}{k}=c~{\\rm~speed~of~light}\n",
    "\\end{equation}\n",
    "\n",
    "in a medium $k=nk_0$\n",
    "\n",
    "- frequency stays the same, wavelength changes\n",
    "- for $n>1$, $\\lambda < \\lambda_0$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "reflection\n",
    "\\begin{equation}\n",
    "\\vec{k}_1\\vec{r}=\\vec{k}_2\\vec{r}\\quad{\\rm at}\\quad\\vec{r}=\\begin{pmatrix}\n",
    "x \\\\ 0 \\\\ 0\n",
    "\\end{pmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{align}\n",
    "\\Rightarrow k_{1x}x &= k_{2x}x\\\\\n",
    "k_1 &= k_2\\\\\n",
    "k_{1z} &= -k_{2z}\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "refraction\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{k}_1\\vec r=\\vec{k}_3\\vec{r}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{align}\n",
    "k_1&=n_1k_0\\\\\n",
    "k_3&=n_2k_0\n",
    "\\end{align}\n",
    "\n",
    "\\begin{equation}\n",
    "k_{1x}=k_{3x}\n",
    "\\end{equation}\n",
    "\n",
    "tangential component conserved\n",
    "\n",
    "- This is a way to construct Snell's law.\n",
    "- Snell's law represents momentum conservation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Relation to Ray Optics\n",
    "\n",
    "limit $\\lambda_0 \\to 0, \\quad (\\nabla^2+k^2)U(\\vec{r})=0$\n",
    "\n",
    "complex amplitude\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=a({\\vec{r}})\\,e^{-ik_0\\delta(\\vec{r})}\n",
    "\\label{U(r)}\n",
    "\\end{equation}\n",
    "\n",
    "$a(r) \\dots$  magnitude\\\n",
    "$-k_0\\delta (r) \\dots$ phase, $k_0=\\frac{2 \\pi}{\\lambda_0}$\\\n",
    "$\\delta(\\vec{r})={\\rm const}$ wavefronts, ??? $\\Delta S$\n",
    "\n",
    "insert \\ref{U(r)} into Helmholtz equation:\n",
    "\n",
    "\\begin{equation}\n",
    "k_0^2(n^2-|\\nabla S|^2)a + \\nabla^2a-ik_0(2 \\nabla S \\nabla a+a \\nabla^2)S=0\n",
    "\\end{equation}\n",
    "\n",
    "$a=a(r), S=S(r)$, real and imaginary parts must be  zero indenpendently\n",
    "\n",
    "$\\Rightarrow$ real part\n",
    "\\begin{equation}\n",
    "|\\nabla S|^2=n^2+\\left(\\frac{\\lambda_0}{2 \\pi}\\right)^2\\frac{\\nabla^2a}{a}\n",
    "\\end{equation}\n",
    "\n",
    "if $a$ varies slowly over distance $\\lambda_0$\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\lambda_0^2\\frac{\\nabla^2 a}{a} \\ll 1\n",
    "\\end{equation}\n",
    "\n",
    "for $\\lambda_0 \\to 0$\n",
    "\\begin{equation}\n",
    "|\\nabla S|^2\\approx n^2 \\quad {\\rm eikonal~equation}\n",
    "\\end{equation}\n",
    "\n",
    "S(r) is proportional to phase $\\Rightarrow$ eikonal in ray optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Transmission through optical components\n",
    "\n",
    "complex amplitude transmittance\n",
    "\n",
    "\\begin{equation}\n",
    "t(x,y)=\\frac{U(x,y,d)}{U(x,y,0)}, \\quad k=nk_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "t(x,y)=e^{-ikd}\n",
    "\\end{equation}\n",
    "\n",
    "variable thickness\n",
    "\n",
    "air: $d_0-d(x,y)$\\\n",
    "glass: d(x,y)\n",
    "\n",
    "\\begin{equation}\n",
    "t(x,y) \\approx e^{-i n_0 k_0 d(x,y)} \\,e^{-ik_0[d_0-d(x,y)]}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow t(x,y) \\approx h_0 e^{-i (n-1) k_0 d(x,y)}, \\quad h_0 =e^{-ik_0d_0}\n",
    "\\end{equation}\n",
    "\n",
    "valid for paraxial approximation ($\\theta$ small) and $d_0$ small\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{d_0}{\\lambda}\\frac{\\theta^2}{2 n} \\ll 1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "d(x,y)=d_0-\\big\\{R-\\sqrt{R^2-(x^2+y^2)}\\big\\} \\quad {\\rm paraxial~approximation}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "x^2+y^2 \\ll R^2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\sqrt{R^2-(x^2+y^2)} \\approx R \\left(1-\\frac{x^2+y^2}{2R^2} \\right)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "t(x,y) \\approx h_0 e^{i k_0 \\left(\\frac{x^2+y^2}{2f}\\right)}, \\quad f=\\frac{R}{n-1}, \\quad h_0=e^{-ink_0d_0} \\quad {\\rm constant~phase}\n",
    "\\end{equation}\n",
    "\n",
    "phase proportional to $x^2+y^2$\n",
    "\n",
    "$\\Rightarrow$ plane wave is ?? to be transformed into a paraboloidal wave centered at $f$ \n",
    "\n",
    "for a biconvex lens\n",
    "\\begin{equation}\n",
    "\\frac 1 f = (n-1) \\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right)\n",
    "\\end{equation}\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "try to do that with a diffraction grating\n",
    "\\begin{equation}\n",
    "d(x,y)=d_0\\left[1+\\cos\\left(\\frac{2 \\pi x}{\\Lambda}\\right)\\right]\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "t(x,y)=h_0 e^{-i \\frac 1 2 (n-1) k_0 d \\cos\\left(\\frac{2 \\pi x}{\\Lambda}\\right)} \\quad {\\rm with} \\quad h_0=e^{-i \\frac 1 2 (n+1) k_0 d_0}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Quantitative Phase Contract Microscopy\n",
    "\n",
    "complex transmitivity of the sample\n",
    "\n",
    "\\begin{equation}\n",
    "t(\\vec{r})=e^{-\\mu(\\vec{r})+i\\phi(\\vec{r})}\n",
    "\\end{equation}\n",
    "\n",
    "measures the distortion of the electromagnetic wave by the sample\n",
    "\n",
    "approximation for optically thin samples:\n",
    "\n",
    "\\begin{equation}\n",
    "t(\\vec{r})\\approx 1-\\mu(\\vec{r})+i\\phi(\\vec{r})\n",
    "\\end{equation}\n",
    "\n",
    "intensity at the camera:\n",
    "\\begin{equation}\n",
    "I(\\vec{r}_{\\rm cam})=\\left|\\int \\int \\left[\\int \\int q(\\vec{r})t(\\vec{r})\\,e^{-i2\\pi\\vec{r}\\vec{u}^{\\prime\\prime}}\\mathrm d^2\\vec{r}\\right] P(\\vec{u}^{\\prime\\prime})\\,e^{-i2\\pi \\vec{u}^{\\prime\\prime}\\vec{r}_{\\rm cam}}\\mathrm d^2 \\vec{u}^{\\prime\\prime}  \\right|^2\n",
    "\\end{equation}\n",
    "\n",
    "differential phase contrast intensity\n",
    "\n",
    "\\begin{equation}\n",
    "I^{\\rm DPC}(\\vec{r}_{\\rm cam})= \\frac{I_T(\\vec{r}_{\\rm cam})-I_B(\\vec{r}_{\\rm cam})}{I_T(\\vec{r}_{\\rm cam})+I_B(\\vec{r}_{\\rm cam})}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Interference"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "superpose $U_1$ and $U_2$\n",
    "\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=U_1(\\vec{r})+U_2(\\vec{r})\n",
    "\\end{equation}\n",
    "\n",
    "intensities $I_1=|U_1|^2,~I_2=|U_2|^2$\n",
    "\n",
    "\\begin{equation}\n",
    "I=|U|^2=|U_1+U_2|^2=|U_1|^2+|U_2|^2+U_1^{*}U_2+U_1U_2^{*}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "U_1=I_1^{\\frac 1 2} e^{i \\phi_1},\\quad U_2=I_2^{\\frac 1 2} e^{i \\phi_2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I=I_1+I_2+2 (I_1I_2)^{\\frac 1 2} \\cos{\\phi},\\quad \\phi=\\phi_2-\\phi_1\n",
    "\\end{equation}\n",
    "\n",
    "for $I_1=I_2=I_0$: $I_{\\max}= 4 I_0$, $I_{\\rm min}=0$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Phasor diagrams"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Interferometers\n",
    "\n",
    "translate phase change into intensity change\n",
    "\n",
    "two different path lengths\n",
    "\n",
    "\\begin{equation}\n",
    "U_1=I_0^{\\frac 1 2}e^{-ikz}, \\quad U_2=I_0^{\\frac 1 2}e^{-ik(z-d)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I=2I_0\\left[1+\\cos\\left(2 \\pi \\frac{d}{\\lambda}\\right)\\right]\n",
    "\\end{equation}\n",
    "\n",
    "?? exist as well"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Multiple wave interference\n",
    "\n",
    "$M$ monochromatic waves $U_1 \\dots U_M$\n",
    "\n",
    "\\begin{equation}\n",
    "U=U_1+U_2 + \\dots + U_M\n",
    "\\end{equation}\n",
    "\n",
    "with $I_1, I_2, I_3, \\dots$\n",
    "\n",
    "\\begin{equation}\n",
    "U_m=I_0^{\\frac 1 2} e^{i (m-1)\\phi}, \\quad m=1 \\dots M\n",
    "\\end{equation}\n",
    "\n",
    "same intensity and the same phase difference between neighbors\n",
    "\n",
    "\\begin{equation}\n",
    "h=e^{i \\phi} \\Rightarrow U_m=I_0^{\\frac 1 2} h^{m-1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{align}\n",
    "\\Rightarrow U&=I_0^{\\frac 1 2} (1+h+h^2+ \\dots + h^{M-1}) \\quad {\\rm geometric~series}\\\\\n",
    "&= I_0^{\\frac 1 2} \\frac{1-h^M}{1-h}\\\\\n",
    "&=I_0^{\\frac 1 2} \\frac{1-e^{iM\\phi}}{1-e^{i\\phi}}\n",
    "\\end{align}\n",
    "\n",
    "\\begin{equation}\n",
    "I=|U|^2=I_0\\left|\\frac{e^{-iM\\frac{\\phi}{2}}-e^{iM\\frac{\\phi}{2}}}{e^{-i\\frac{\\phi}{2}}-e^{i\\frac{\\phi}{2}}}\\right|^2=\\frac{\\sin^2\\left(\\frac{M\\phi}{2}\\right)}{\\sin^2\\left(\\frac{\\phi}{2}\\right)}\n",
    "\\end{equation}\n",
    "\n",
    "peak intensity $I_{\\rm max}=M^2I_0, \\bar I=MI_0$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Coherence"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Interference with progressively smaller amplitudes\n",
    "\n",
    "\\begin{equation}\n",
    "U_1=I_0^{\\frac 1 2}, \\quad U_2=hU_1, \\quad U_3=h^2U_1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "h=re^{i\\phi}, \\quad r<1~{\\rm is~the~reflectivity}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I=\\frac{I_0}{(1-r)^2+4r \\sin^2\\left(\\frac{\\phi}{2}\\right)}, \\quad \\phi=2\\pi m, \\quad m \\ge 1\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I=\\frac{I_{\\rm max}}{1+\\left(\\frac{2 \\tilde \\nu}{\\pi} \\right)^2 \\sin^2\\left(\\frac{\\phi}{2}\\right)}, \\quad I_{\\rm max}=\\frac{I_0}{(1-\\nu)^2}\n",
    "\\end{equation}\n",
    "\n",
    "Finesse\n",
    "\\begin{equation}\n",
    "\\mathcal{F}=\\frac{\\pi r^{\\frac 1 2}}{1-r}=\\frac{\\Delta \\lambda}{\\delta \\lambda} \\simeq \\frac{\\delta \\omega}{\\Delta \\omega}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Delta \\omega=\\frac{2 \\delta \\omega}{\\pi \\tilde \\nu}, \\quad \\delta \\omega=\\frac{c}{2nd}\\quad {\\rm free~spectral~range}\n",
    "\\end{equation}\n",
    "\n",
    "width of the interference peak given by\n",
    "\\begin{equation}\n",
    "\\Delta \\phi=\\frac{2 \\pi }{\\mathcal{F}}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fabryâ€“Perot interferometer\n",
    "\n",
    "Laser cavities are often described as Fabryâ€“Perot interferometers."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### application of interference\n",
    "\n",
    "digital holography for single particle tracking"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Light beating\n",
    "\n",
    "interference in the time domain\n",
    "\n",
    "two monochromatic waves of different frequencies $\\nu_1, \\nu_2$\n",
    "\n",
    "\\begin{equation}\n",
    "U(t)=I_1^{\\frac 1 2} e^{i2\\pi \\nu_1 t}+I_2^{\\frac 1 2} e^{i2\\pi \\nu_2 t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I(t)=I_1+I_2+2(I_1I_2)^{\\frac 1 2} \\cos (2 \\pi (\\nu_2-\\nu_1)t)\n",
    "\\end{equation}\n",
    "\n",
    "beat frequency $|\\nu_2-\\nu_1|$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### multiple monochromatic waves\n",
    "\n",
    "odd number of waves (same spatial phase)\n",
    "\n",
    "\\begin{equation}\n",
    "M=2L+1, \\quad {\\rm each~with}~I_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nu_q=\\nu_0+q\\nu_F, \\quad q=-L,\\dots, 0, \\dots, L\n",
    "\\end{equation}\n",
    "\n",
    "intervall $\\nu_F \\ll \\nu_0$, $\\nu_0 \\dots$ center frequency\n",
    "\n",
    "\\begin{equation}\n",
    "U(t)=I_0^{\\frac 1 2} \\sum_{q=-L}^L e^{i2\\pi (\\nu_0+q\\nu_F)t}\n",
    "\\end{equation}\n",
    "\n",
    "sum of $M$ phasors again with $\\phi=2\\pi \\nu_Ft$\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I(t)=|U(t)|^2=I_0\\frac{\\sin^2 \\left(\\frac{M\\pi t}{T_F} \\right)}{\\sin^2\\left(\\frac{\\pi t}{T_F} \\right)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "T_F=\\frac{1}{\\nu_F}, \\quad I_{\\rm max}=M^2 I_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "{\\rm width~of~pulse} \\approx \\frac{T_F}{M}\n",
    "\\end{equation}\n",
    "\n",
    "for example $\\nu_f \\approx 1$ GHz, $T_F=1$ ns, $M=1000 \\Rightarrow $ pulse $1$ ps"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "mode (phase) locking"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "coupled modes\n",
    "\n",
    "pulses occur separated in time by $\\tau=\\frac{2L}{c}$, $\\Delta \\nu=\\frac{1}{\\tau}$\n",
    "$\\Rightarrow$ frequency comb"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Gaussian beam\n",
    "\n",
    "so far plane wave:\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=U_0 e^{-ikz}\n",
    "\\end{equation}\n",
    "\n",
    "now we give the beam an envelope:\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=A(\\vec{r})e^{-ikz}\n",
    "\\end{equation}\n",
    "\n",
    "envelope shall be approximately constant in range $\\lambda$\n",
    "\n",
    "$U(\\vec{r}) \\Rightarrow$ Helmholtz equation $\\nabla^2U+k^2U=0$\n",
    "\n",
    "If $A(\\vec{r})$ varies slowly with $\\Delta z= \\lambda$, then $\\Delta A \\ll A$ and we can write\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla_T^2A-i2k \\frac{\\partial A}{\\partial z}=0 \\quad {\\rm paraxial~Helmholz~equation}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla^2_T=\\frac{\\partial^2}{\\partial x^2}+\\frac{\\partial^2}{\\partial y^2}\n",
    "\\end{equation}\n",
    "\n",
    "most useful solution of the paraxial Helmholtz equation is the Gaussian beam\n",
    "\n",
    "paraboloidal wave\n",
    "\\begin{equation}\n",
    "A(r)=\\frac{A_1}{z}e^{-ik \\frac{\\rho^2}{2z}}, \\quad \\rho^2=x^2+y^2\n",
    "\\end{equation}\n",
    "\n",
    "shifted paraboloidal wave\n",
    "\\begin{equation}\n",
    "A(r)=\\frac{A_1}{q(z)}e^{-ik \\frac{\\rho^2}{2 q(z)}}, \\quad q(z)=z-\\xi\n",
    "\\end{equation}\n",
    "\n",
    "works also with complex shift (phase) $q(z)=z+iz_0$, $z_0 \\dots$ Rayleigh range\n",
    "\n",
    "\\begin{equation}\n",
    "A(r)=\\frac{A_1}{q(z)} e^{-ik \\frac{\\rho^2}{2 q(z)}}, \\quad {\\rm complex~envelope}\n",
    "\\end{equation}\n",
    "\n",
    "separate $q(z)$ in real and imaginary part\n",
    "\\begin{equation}\n",
    "\\frac{1}{q(z)}=\\frac{1}{R(z)}-i\\frac{\\lambda}{\\pi W^2(z)}\n",
    "\\end{equation}\n",
    "\n",
    "$q(z) \\dots$ complex radius of ???\\\n",
    "$R(z)$ and $W(z)$ characterize the beam\n",
    "\n",
    "total complex amplitude of the Gaussian beam\n",
    "\\begin{equation}\n",
    "U(\\vec{r})=A_0\\frac{W_0}{W(z)}e^{-\\frac{\\rho^2}{W^2(z)}}e^{-ikz -ik \\frac{\\rho^2}{2 R(z)}+i\\zeta (z)}\n",
    "\\end{equation}\n",
    "\n",
    "beam parameters:\n",
    "\\begin{equation}\n",
    "W (z)=W_0 \\left[ 1 + \\left(\\frac{z}{z_0} \\right)^2 \\right]^{\\frac 1 2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "R (z)=z\\left[ 1 + \\left(\\frac{z_0}{z} \\right)^2 \\right]\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\zeta (z)=\\tan^{-1}\\left(\\frac{z}{z_0} \\right)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "W_0=\\left(\\frac{\\lambda z_0}{\\pi} \\right)^{\\frac 1 2}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Propierties\n",
    "\n",
    "intensity\n",
    "\\begin{equation}\n",
    "I(\\vec{r})=|U(\\vec{r})|^2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I(\\rho,z)=I_0 \\left[\\frac{W_0}{W (z)} \\right]^2 e^{-\\frac{2 \\rho^2}{W^2 (z)}}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I_0=|A_0|^2\n",
    "\\end{equation}\n",
    "\n",
    "$\\perp$ to $z$-axis\n",
    "\n",
    "along $z$-axis $\\rho=0$\n",
    "\\begin{equation}\n",
    "I(0,z)=I_0 \\left[\\frac{W_0}{W(z)} \\right]^2 = \\frac{I_0}{1+\\left(\\frac{z}{z_0} \\right)^2}\n",
    "\\end{equation}\n",
    "\n",
    "$I(0,0)=I_0$\n",
    "\n",
    "for $|z| \\gg z_0$\n",
    "\n",
    "\\begin{equation}\n",
    "I(0,z)=I_0 \\frac{z_0^2}{z^2}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ inverse square law like spherical wave"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "optical power\n",
    "\n",
    "\\begin{equation}\n",
    "P=\\int_0^\\infty I(\\rho,z)2\\pi \\rho\\, \\mathrm d\\rho=\\frac 1 2 I_0 (\\pi W_0^2)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow I(\\rho,z)=\\frac{2 P}{\\pi W^2(z)}e^{-\\frac{2\\rho^2}{W^2(z)}}\n",
    "\\end{equation}\n",
    "\n",
    "total power within a certain radius\n",
    "\\begin{equation}\n",
    "\\frac 1 P \\int_0^{\\rho_0}I(\\rho,z)2\\pi \\rho \\, \\mathrm d\\rho=1-e^{\\frac{-2\\rho_0^2}{W^2(z)}}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{align}\n",
    "\\Rightarrow \\rho_0&=W(z) \\Rightarrow 86~\\%\\\\\n",
    "\\rho_0&=1.5 W(z) \\Rightarrow 99~\\%\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "beam radius\n",
    "\n",
    "\\begin{equation}\n",
    "W(z)=W_0 \\left[1+\\left(\\frac{z}{z_0} \\right)^2\\right]^{\\frac 1 2}\n",
    "\\end{equation}\n",
    "\n",
    "$W_0$ is at $z=0 \\Rightarrow$ beam waist \\\n",
    "$W_0 \\dots$ waist radius \\\n",
    "$2 W_0 \\dots$ spot size\n",
    "\n",
    "at $z=z_0, W(z)=\\sqrt{2} W_0$\n",
    "\n",
    "for $z \\gg z_0$\n",
    "\n",
    "\\begin{equation}\n",
    "W(z)=\\frac{W_0}{z_0}z=\\theta_0z\\quad {\\rm with} \\quad \\theta_0=\\frac{W_0}{z_0}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\theta_0=\\frac{\\lambda}{\\pi W_0}\n",
    "\\end{equation}\n",
    "\n",
    "beam waist increases linearly at large distance $\\Rightarrow$ ray optics\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "beam divergence\n",
    "\n",
    "for $z \\gg z_0$ ??? with opening angle $\\theta_0$, $86~\\%$ of power contained in that\n",
    "\n",
    "divergence angle\n",
    "\\begin{equation}\n",
    "\\theta_0=\\frac{1}{\\pi} \\frac{\\lambda}{W_0}\n",
    "\\end{equation}\n",
    "\n",
    "simlarly for slit $\\theta=\\frac \\lambda b$, circular aperture $\\theta=\\frac{1.22 \\lambda}{2a} \\Rightarrow$ Heisenberg"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "depth of focus\n",
    "\\begin{equation}\n",
    "2z_0=\\frac{2 \\pi W_0^2}{\\lambda}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "phase\n",
    "\\begin{equation}\n",
    "\\phi(\\rho,z)=k z-\\zeta z+\\frac{k\\rho^2}{2R(z)}\n",
    "\\end{equation}\n",
    "\n",
    "on axis $\\rho=0$\n",
    "\\begin{equation}\n",
    "\\phi(0,z)=k z-\\zeta (z)\n",
    "\\end{equation}\n",
    "\n",
    "$\\rho \\dots$ phase of a plane wave \\\n",
    "$\\zeta (z) \\dots$ additonal retardation from $-\\frac \\pi 2~(z=-\\infty)$ to $\\frac \\pi 2~( z=\\infty)$\n",
    "\n",
    "Guoy phase\n",
    "\n",
    "\\begin{equation}\n",
    "v_p=\\frac{c}{1-\\frac{\\lambda}{2 \\pi z} \\arctan \\left(\\frac{z}{z_0} \\right)}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "wavefronts\n",
    "\n",
    "surfaces of constant phase\n",
    "\n",
    "\\begin{equation}\n",
    "k\\left[z+\\frac{\\rho^2}{2 R(z)} \\right]-\\zeta (z)=2 \\pi m = {\\rm const}\n",
    "\\end{equation}\n",
    "\n",
    "paraboloidal wave\n",
    "\n",
    "\\begin{equation}\n",
    "kz=2 \\pi m -\\frac{k \\rho^2}{2 R(z)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "z=\\frac{2 \\pi m}{k}-\\frac{\\rho^2}{2 R(z)}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Transmission through a lens\n",
    "\n",
    "complex transmittance of a lens $e^{ik \\frac{\\rho^2}{2f}}$\n",
    "\n",
    "This is then an additonal phase shift\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow kz + k \\frac{\\rho^2}{2R}-\\zeta-k\\frac{\\rho^2}{2f}=kz+k\\frac{\\rho^2}{2R'}-\\zeta\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "k \\frac{\\rho^2}{2R}-k\\frac{\\rho^2}{2f}=k\\frac{\\rho^2}{2R'}\n",
    "\\end{equation}\n",
    "or\n",
    "\\begin{equation}\n",
    "\\frac{1}{R'}=\\frac{1}{R}-\\frac{1}{f}\n",
    "\\end{equation}\n",
    "with $R'<0, R>0$\n",
    "\n",
    "- curvature of the wavefront satisfies imaging equation\n",
    "- new beam width $W^2_0$\n",
    "\n",
    "\\begin{equation}\n",
    "W'_0=\\frac{W}{\\left[1+\\left(\\frac{\\pi W^2}{\\lambda R'}\\right)^2\\right]^{\\frac 1 2}}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "W'_0 \\approx \\frac{\\lambda R'}{\\pi W}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "-z'=\\frac{R'}{1+\\left(\\frac{\\lambda R'}{\\pi W^2} \\right)^2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "W=W_0\\left[1+\\left(\\frac{z}{z_0} \\right)^2\\right]^{\\frac 1 2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "R=z\\left[1+\\left(\\frac{z_0}{z} \\right)^2\\right]\n",
    "\\end{equation}\n",
    "\n",
    "waist radius\n",
    "\\begin{equation}\n",
    "W'_0=MW_0\n",
    "\\end{equation}\n",
    "\n",
    "waist location\n",
    "\\begin{equation}\n",
    "(z'-f)=M^2(z-f)\n",
    "\\end{equation}\n",
    "$\\Rightarrow$ waist is magnified\n",
    "\n",
    "depth of focus\n",
    "\\begin{equation}\n",
    "2z'_0=M^2(2z_0)\n",
    "\\end{equation}\n",
    "\n",
    "divergence\n",
    "\\begin{equation}\n",
    "2\\theta'_0=\\frac{2\\theta_0}{M}\n",
    "\\end{equation}\n",
    "\n",
    "magnification\n",
    "\\begin{equation}\n",
    "M=\\frac{M_r}{(1+r^2)^{\\frac 1 2}}, \\quad r = \\frac{z_0}{z-f}, \\quad M_r=\\left|\\frac{f}{z-f}\\right|\n",
    "\\end{equation}\n",
    "\n",
    "ray optics limit\n",
    "\\begin{equation}\n",
    "(z-f)\\gg z_0, \\quad r \\ll 1, \\quad M=M_r, \\quad W'_0=MW_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{1}{z'}+\\frac 1 z = \\frac 1 f\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Matrix Optics\n",
    "\n",
    "\\begin{equation}\n",
    "q_2=\\frac{Aq_1+B}{Cq_1+D} \\quad {\\rm ABCD~law}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "M=\n",
    "\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}, \\quad q=z+iz_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "q_2=q_1+d = \\frac{1 q_1+d}{0 q_1+1}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac 1 q = \\frac 1 R -i \\frac{\\lambda}{\\pi W^2} \n",
    "\\end{equation}\n",
    "contains information on $R$ and $W$\n",
    "\n",
    "thin lens\n",
    "\\begin{equation}\n",
    "q_2=\\frac{Aq_1+B}{Cq_1+D}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{bmatrix}=\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "Example: focusing of a Gaussian beam\n",
    "\n",
    "incident beam:\n",
    "\\begin{equation}\n",
    "\\frac{1}{q_1}=\\frac{1}{\\infty}-\\frac{i\\lambda}{\\pi W^2_0}, \\quad \\frac{1}{q}=\\frac{1}{R}-\\frac{i\\lambda}{\\pi W^2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "q_1=i\\frac{\\pi W^2_0}{\\lambda}\n",
    "\\end{equation}\n",
    "\n",
    "propagation matrix lens + free space\n",
    "\\begin{equation}\n",
    "\\begin{bmatrix}\n",
    "A & B \\\\\n",
    "C & D\n",
    "\\end{bmatrix}=\\begin{bmatrix}\n",
    "1 & d \\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0 \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}=\\begin{bmatrix}\n",
    "1-\\frac d f & d \\\\\n",
    "-\\frac 1 f & 1\n",
    "\\end{bmatrix}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow q_2=\\frac{1}{\\frac{1}{R_2}-\\frac{i \\lambda}{\\pi W^2_2}}=\\frac{\\left(1-\\frac d f\\right) \\left(i\\frac{\\pi W^2_0}{\\lambda} \\right)+d}{-\\frac 1 f \\left(i\\frac{\\pi W^2_0}{\\lambda} \\right)+1}\n",
    "\\end{equation}\n",
    "\n",
    "since $z_0=\\frac{\\pi W^2_0}{\\lambda}$\n",
    "\\begin{equation}\n",
    "R_2(d)=\\frac{\\left(\\frac{d}{z_0} \\right)^2+\\left(1-\\frac d f \\right)^2}{\\left(\\frac{d}{z_0^2} \\right)-\\frac 1 f \\left(1-\\frac d f \\right)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "W_2^2(d)=W_0^2 \\left(1-\\frac d f \\right)^2+W_0^2 \\left(\\frac{d}{z_0} \\right)^2\n",
    "\\end{equation}\n",
    "\n",
    "The beam waist after the lens is at $R_2(d)=\\infty$\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow d=\\frac{f}{1+\\frac{f^2}{z_0^2}}\n",
    "\\end{equation}\n",
    "\n",
    "$d < f$\n",
    "\n",
    "for $z_0=0, d=0$ (ray optics)\n",
    "\n",
    "\\begin{equation}\n",
    "W_2=\\frac{W_0}{\\left( 1+ \\left( \\frac{z_0}{f}\\right)^2\\right)^{\\frac 1 2}}\n",
    "\\end{equation}\n",
    "\n",
    "for $2z_0 \\gg f$\n",
    "\n",
    "\\begin{equation}\n",
    "W_2=\\frac{\\lambda}{\\pi W_0 f}=\\theta_0 f, \\quad d=f\n",
    "\\end{equation}\n",
    "focused to the focal point"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Higher order Gaussian beams\n",
    "\n",
    "(non-Gaussian intensity)\n",
    "\n",
    "\\begin{equation}\n",
    "U(\\vec{r}) =g(x,z)h(y,z)e^{i k \\frac{\\rho^2}{2 g(z)}}e^{i\\phi(z)}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ insert into paraxial Helmholtz equation\n",
    "\n",
    "\\begin{equation}\n",
    "U_{m,n}=\\frac{A}{W(z)}H_m\\left(\\frac{\\sqrt 2 x}{W(z)} \\right)H_n \\left(\\frac{\\sqrt 2 y}{W(z)} \\right)e^{-\\frac{\\rho^2}{W^2(z)}}e^{-ik\\frac{\\rho^2}{2 R}}e^{-i\\phi(z)}\n",
    "\\end{equation}\n",
    "\n",
    "$H \\dots$ Hermite Polynomials\\\n",
    "\\begin{equation}\n",
    "H_0(u)=1, \\quad H_1(u)=20, \\quad H_2(u)=4 u^2-2, \\dots\n",
    "\\end{equation}\n",
    "\n",
    "order of the solution $N=m+n$\n",
    "\n",
    "- still paraboloidal wavefunctions\n",
    "- reflected by spherical mirrors to form a resonator"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Cylindrical coordinates\n",
    "\n",
    "\\begin{equation}\n",
    "\\rho=\\sqrt{x^2+y^2}, \\quad \\theta=\\tan^{-1}\\left(\\frac{y}{x}\\right), \\quad z=z\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "U_{p,l}(\\rho, \\theta, z)=\\frac{A}{W(z)}\\left(\\frac{\\sqrt 2 \\rho}{W(z)} \\right)^l L_p^l \\left(\\frac{2 \\rho^2}{W(z)} \\right)e^{-\\frac{\\rho^2}{W^2}} e^{ik\\frac{\\rho^2}{2 R}} e^{-il\\phi} e^{i(|l|+2p+1)\\zeta(z)}\n",
    "\\end{equation}\n",
    "\n",
    "$L_p^l \\dots$ Laguerre Polynomials, order $N=2p+|l|$\\\n",
    "$p \\ge 0 \\dots $ radial order\\\n",
    "$l \\dots$ azimuthal order, positive/negative\\\n",
    "$e^{-il\\phi} \\dots$ helical ?? of wavefunction\\\n",
    "$l \\dots$ topological charge\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Gaussâ€“Laguerre beams"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.3 Electromagnetic Optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Light is an electromagnetic wave, contains electric and magnetic fields and these are vectors.\n",
    "\n",
    "Maxwell\n",
    "\n",
    "free space\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{H} = \\varepsilon_0 \\frac{\\partial \\vec{E}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{E} = -\\mu_0 \\frac{\\partial \\vec{H}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{E}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{H}=0\n",
    "\\end{equation}\n",
    "\n",
    "$\\varepsilon_0=\\frac{1}{36 \\pi} \\cdot 10^{-9}~\\frac{\\rm F}{\\rm m} \\dots$ permittivity\\\n",
    "$\\mu_0=4 \\pi \\cdot 10^{-7}~\\frac{\\rm H}{\\rm m} \\dots$ permeability\n",
    "\n",
    "in a medium\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t}+\\vec{j}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{D}=\\rho\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{B}=0\n",
    "\\end{equation}\n",
    "\n",
    "source free medium\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{B} = \\mu_0 \\frac{\\partial \\vec{D}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{D}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{B}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{D}=\\varepsilon_0 \\vec{E}+\\vec{P}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{B}=\\mu_0\\vec{H}+\\mu_0\\vec{M}\n",
    "\\end{equation}\n",
    "\n",
    "$\\vec{P} \\dots$ polarization\\\n",
    "$\\vec{M} \\dots$ magnetization\n",
    "\n",
    "with $\\nabla \\times \\nabla \\times E=\\nabla(\\nabla E)-\\nabla^2 E=-\\nabla^2 E$\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "wave equation\n",
    "\n",
    "free space:\n",
    "\\begin{equation}\n",
    "\\nabla^2\\vec{E}-\\varepsilon_0\\mu_0\\frac{\\partial^2 \\vec{E}}{\\partial t^2}=0, \\quad c=\\frac{1}{\\sqrt{\\mu_0\\varepsilon_0}}\n",
    "\\end{equation}\n",
    "\n",
    "medium:\n",
    "\\begin{equation}\n",
    "\\nabla^2\\vec{E}-\\varepsilon\\varepsilon_0\\mu\\mu_0\\frac{\\partial^2 \\vec{E}}{\\partial t^2}=0, \\quad c=\\frac{1}{\\sqrt{\\mu_0\\mu\\varepsilon\\varepsilon_0}}\n",
    "\\end{equation}\n",
    "\n",
    "we know already\n",
    "\\begin{equation}\n",
    "\\vec{E}(\\vec{r},t)=Re \\big\\{\\vec{E}(\\vec{r})e^{i\\omega t}\\big\\}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{B}(\\vec{r},t)=Re \\big\\{\\vec{B}(\\vec{r})e^{i\\omega t}\\big\\}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{E}=-i\\omega \\vec{B}(\\vec{r})\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{B}=i\\varepsilon_0 \\omega \\mu_0 \\vec{E}(\\vec{r})\n",
    "\\end{equation}\n",
    "\n",
    "for a plane wave\n",
    "\\begin{equation}\n",
    "\\vec{E}(\\vec{r})=\\vec{E}_0e^{-i\\vec k \\vec r}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{B}(\\vec{r})=\\vec{B}_0 e^{-i \\vec{k}\\vec{r}}\n",
    "\\end{equation}\n",
    "\n",
    "follows\n",
    "\\begin{equation}\n",
    "\\vec{k} \\times \\vec{B}=-\\frac{\\omega}{c^2}\\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{k}\\times \\vec{E}=\\omega \\vec{B}\n",
    "\\end{equation}\n",
    "\n",
    "If ?? the left you find\n",
    "\\begin{equation}\n",
    "|\\vec{B}_0|=\\frac{|\\vec{E}_0|}{c}\n",
    "\\end{equation}\n",
    "\n",
    "transverse electromagnetic wave"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "energy density\n",
    "\\begin{equation}\n",
    "u=u_E+u_B, \\quad u_E=\\frac{\\varepsilon_0}{2}|\\vec{E}|^2, \\quad u_B=\\frac{1}{2 \\mu_0}|\\vec{B}|^2\n",
    "\\end{equation}\n",
    "\n",
    "since $|\\vec{B}|=\\frac{|\\vec{E}|}{c}$\n",
    "\n",
    "\\begin{equation}\n",
    "u=\\frac{\\varepsilon_0}{2}|\\vec{E}|^2+\\frac{1}{2 \\mu_0 c^2}|\\vec{E}|^2=\\varepsilon_0 |\\vec{E}|^2\n",
    "\\end{equation}\n",
    "\n",
    "energy is shared in equal parts by $\\vec{E}$ and $\\vec{B}$\n",
    "\n",
    "energy flow\n",
    "\\begin{equation}\n",
    "\\vec{j}=\\rho \\cdot \\vec{v}\n",
    "\\end{equation}\n",
    "\n",
    "$\\vec{j} \\to \\vec{S}, \\vec{v} \\to c$, direction $\\vec{k}$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Poynting vector\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{S}=\\frac{1}{\\mu_0}\\vec{E} \\times \\vec{B}=\\vec{E} \\times {H}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I=\\langle |\\vec{S}| \\rangle_t \\quad {\\rm time~average~(one~cycle)}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{E_0}{H_0}=\\eta_0, \\quad \\eta_0=\\mu_0c_0=\\sqrt{\\frac{\\mu_0}{\\varepsilon_0}}\\approx 377~{\\rm \\Omega},~{\\rm impedance~of~vacuum}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I=\\frac{|E_0|^2}{2 \\eta_0}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Radiation pressure\n",
    "\n",
    "\\begin{equation}\n",
    "p=\\frac{|\\vec{S}|}{c}, \\quad \\frac{\\rm W}{\\rm m^2}\\frac{\\rm s}{\\rm m}=\\frac{\\rm J}{\\rm m^3}=\\frac{\\rm N}{\\rm m^2}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### How is a medium influencing the wave propagation?\n",
    "\n",
    "electron cloud is displaced against the nucleus by $\\Delta \\vec{r}$\n",
    "\n",
    "dipole $\\Rightarrow \\vec{p}=q \\Delta \\vec{r}$\n",
    "\n",
    "field of one elementary charge at $10^{-10}$ m\n",
    "\n",
    "\\begin{equation}\n",
    "E=\\frac{e}{4 \\pi \\varepsilon_0 r^2}=1.4 \\cdot 10^{11}~\\frac{\\rm V}{\\rm m}\n",
    "\\end{equation}\n",
    "\n",
    "corresponds to $I=2.75\\cdot 10^{13}~\\frac{\\rm W}{\\rm mm^2}$\n",
    "\n",
    "$\\Rightarrow$ The effect of light at the atom is small at first glance.\n",
    "\n",
    "$\\Rightarrow$ Many atomic dipoles will sum up to a dipole per unit volume $\\vec{P}~\\hat{=}$ polarization density\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}=N\\vec{p}, \\quad N \\dots {\\rm number~density}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "G_b=-\\oint_S \\vec{P}\\mathrm d\\vec{S}\\quad \\Rightarrow \\quad Q_b=-\\int_V\\nabla \\cdot \\vec{P}\\mathrm dV\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\rho_b=-\\nabla P \\quad{\\Rightarrow \\rm also~creating~displacement~currents}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{j}=Nq\\vec{v}=\\frac{\\mathrm d\\vec{P}}{\\mathrm dt}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\varepsilon_0 \\nabla \\vec{E}=-\\nabla \\vec{P} \\quad {\\rm from}~\\nabla D=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{B}=\\mu_0\\frac{\\partial \\vec{P}}{\\partial t}+\\varepsilon_0\\mu_0\\frac{\\partial \\vec{E}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "new quantity\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{D}=\\varepsilon_0 \\vec{E}+\\vec{P} \\quad (\\rm electric~flux~density)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\vec{\\nabla} \\vec{D}=0 \\quad \\Rightarrow \\quad \\varepsilon_0 \\vec{\\nabla}\\vec{E}=-\\vec{\\nabla}\\vec{P}\n",
    "\\end{equation}\n",
    "\n",
    "same with $\\vec{H}$\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{B}=\\mu_0 \\vec{H}+\\vec{M}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ in a source free medium, no charges and currents\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{B} = \\mu_0 \\frac{\\partial \\vec{D}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{D}=0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\cdot \\vec{B}=0\n",
    "\\end{equation}\n",
    "\n",
    "We will assume $\\vec{M}=0$ in the rest of the course, $\\vec{B}=\\mu_0\\vec{H}+\\mu_0 \\vec{M}$\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Types of polarization\n",
    "\n",
    "a) electronic\n",
    "\n",
    "b) orientational\n",
    "\n",
    "c) ionic\n",
    "\n",
    "d) molecular degeneration"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Dielectric media\n",
    "\n",
    "- The dielectric medium is characterized by the medium equation, i.e., the relation between polarization and field vectors.\n",
    "- Can also by characterized by"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### linear media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}\\propto \\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "#### nondispersive media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}(t)\\propto \\vec{E}(t)\n",
    "\\end{equation}\n",
    "\n",
    "same time\n",
    "\n",
    "history of $\\vec{E}$ is not ?\n",
    "\n",
    "#### homogeneous media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}=f(\\vec{E})\n",
    "\\end{equation}\n",
    "\n",
    "and independent of the position\n",
    "\n",
    "#### isotropic media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}=f(\\vec{E})\n",
    "\\end{equation}\n",
    "\n",
    "and independent of the direction of $\\vec{E}$\n",
    "\n",
    "#### inhomogeneous media\n",
    "\n",
    "$\\chi (\\vec{r}), \\varepsilon (\\vec{r}) \\Rightarrow n(\\vec{r})$\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\left[\\nabla^2-\\frac{1}{c(\\vec{r})}\\partial^2_t \\right] \\vec{E}=0\n",
    "\\end{equation}\n",
    "\n",
    "$c(\\vec{r})$ varies slowly\n",
    "\n",
    "more general\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\times \\nabla \\times E=\\nabla(\\nabla E)-\\nabla^2\\varepsilon\n",
    "\\end{equation}\n",
    "\n",
    "with\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla \\varepsilon E=0 \\quad \\Rightarrow \\quad \\nabla \\varepsilon E =\\varepsilon \\nabla E+E\\nabla \\varepsilon\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\nabla E=-\\frac{1}{\\varepsilon}\\nabla \\varepsilon \\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla^2\\vec{E}-\\frac{1}{c^2(\\vec{r})}\\partial^2_t\\vec{E}+\\vec{\\nabla}\\left(\\frac{1}{\\varepsilon(\\vec{r})}\\vec{E}\\vec{\\nabla}\\varepsilon \\right)=0\n",
    "\\end{equation}\n",
    "\n",
    "$\\frac{1}{\\varepsilon(\\vec{r})}\\vec{E}\\vec{\\nabla}\\varepsilon \\approx 0$ if $\\varepsilon (\\vec{r})$ varies below $\\lambda$\n",
    "\n",
    "#### anisotropic media\n",
    "\n",
    "\\begin{equation}\n",
    "P_i=\\sum_j \\varepsilon_0 \\chi_{ij}E_j, \\quad D_i=\\sum_j \\varepsilon_{ij}E_j\n",
    "\\end{equation}\n",
    "\n",
    "#### dispersive media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}(t)=\\varepsilon_0 \\int_{-\\infty}^\\infty h(t-t')\\vec{E}(t')\\mathrm dt'\n",
    "\\end{equation}\n",
    "\n",
    "#### nonlinear media\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}=a_1\\vec{E}+a_2\\vec{E}^2+a_3\\vec{E}^3+ \\dots\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\nabla^2\\vec{E}-\\frac{1}{c^2}\\partial^2_t \\vec{E}=\\mu_0 \\partial^2_t \\vec{P}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Linear, nondispersive, homogeneous, isotropic media\n",
    "\n",
    "incident plane wave\n",
    "\n",
    "\\begin{equation}\n",
    "E_s=E_0e^{i(\\omega t -kz)}\n",
    "\\end{equation}\n",
    "\n",
    "at $P$: $E=E_s+E_a$\n",
    "\n",
    "if the effect of the material is to delay the wave then\n",
    "\n",
    "\\begin{equation}\n",
    "  \\left.\\begin{aligned}\n",
    " {\\rm before~???}~\\frac{\\Delta z}{c}\\\\\n",
    "  {\\rm after}~n\\frac{\\Delta z}{c}\n",
    "\\end{aligned}\\right\\}  \\Delta t = (n-1)\\frac{\\Delta z}{c}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "\\begin{align}\n",
    "E&=E_0 e^{-i(\\omega t-kz-(n-1)k\\Delta z)}\\\\\n",
    "&= e^{-i \\omega(n-1)\\Delta z/c}E_0e^{i (\\omega t-kz)}\\\\\n",
    "&=e^{-i\\theta} E_s\n",
    "\\end{align}\n",
    "\n",
    "with $\\theta=k(n-1)\\Delta z$ phase retardation\n",
    "\n",
    "for small $\\theta$\n",
    "\n",
    "\\begin{equation}\n",
    "e^x \\sim 1+ x+\\left(\\frac{x^2}{2} \\right)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow e^{-ik(n-1)\\Delta z} \\approx 1-ik(n-1)\\Delta z -\\frac{k^2(n-1)^2 \\Delta z^2}{2}\n",
    "\\end{equation}\n",
    "\n",
    "$\\Rightarrow$ behind the plate:\n",
    "\n",
    "\\begin{equation}\n",
    "E=E_0e^{i(\\omega t-kz)}-ik(n-1)\\Delta z E_0 e^{i(\\omega t -kz)}=E_s+E_a\n",
    "\\end{equation}\n",
    "\n",
    "The electric field is due to the additional ??? retarded.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\\begin{equation}\n",
    "\\vec{P}=\\varepsilon_0\\chi\\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "$\\chi \\dots$ electric susceptibility (scalar)\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{D}=\\varepsilon_0 \\vec{E}+\\vec{P}=\\varepsilon_0 \\vec{E}+\\varepsilon_0 \\chi\\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{D}=\\varepsilon_0(1+\\chi)\\vec{E}=\\varepsilon \\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{\\varepsilon}{\\varepsilon_0}=1+\\chi=\\varepsilon_r\n",
    "\\end{equation}\n",
    "\n",
    "is the relative dielectric constant\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{D}=\\varepsilon_r\\varepsilon_0 \\vec{E}\n",
    "\\end{equation}\n",
    "\n",
    "The wave equation now gives\n",
    "\n",
    "\\begin{equation}\n",
    "c=\\frac{c_0}{n} \\quad {\\rm with} \\quad n=\\sqrt{\\varepsilon_r}=\\sqrt{1+\\chi}\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### microscopic model of $P$\n",
    "\n",
    "damped harmonic oscillator\n",
    "\n",
    "\\begin{equation}\n",
    "\\ddot{x}+\\sigma \\dot{x}+\\omega_0^2x=\\frac{q}{m}E(t)\n",
    "\\end{equation}\n",
    "\n",
    "$E(t) \\dots$ light field\n",
    "\n",
    "\\begin{equation}\n",
    "E(t)=E_0e^{-i\\omega t} \\quad \\Rightarrow \\quad x(t)=x_0 e^{-i \\omega t}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "x(t)\\frac{1}{\\omega_0^2-i\\omega \\sigma-\\omega^2}\\frac{q}{m} E(t)\n",
    "\\end{equation}\n",
    "\n",
    "linear response\n",
    "\n",
    "electron that radiates\n",
    "\n",
    "\\begin{align}\n",
    "E_a&=-\\frac{\\eta q_e}{2 \\varepsilon_0 c}\\dot{x}\\left(t-\\frac z c\\right)\\\\\n",
    "&=-\\frac{\\eta q_e}{2 \\varepsilon_0 c} \\left[i \\omega \\frac{q_e E_0}{m(\\omega_0^2-\\omega^2)}e^{i (\\omega t-kz)} \\right]\n",
    "\\end{align}\n",
    "\n",
    "with $k=\\frac{\\omega}{c}$\n",
    "\n",
    "\\begin{equation}\n",
    "(n-1)\\Delta z=\\frac{\\eta q_e^2}{2 \\varepsilon_0 m(\\omega_0^2-\\omega^2)} \\quad \\Rightarrow \\quad n=1+\\frac{Nq_e^2}{2 \\varepsilon_0 m (\\omega_0^2-\\omega^2)}\n",
    "\\end{equation}\n",
    "\n",
    "more general\n",
    "\n",
    "dipole\n",
    "\n",
    "\\begin{equation}\n",
    "p=q x(t)=\\alpha(\\omega)E(t)\n",
    "\\end{equation}\n",
    "\n",
    "$\\alpha (\\omega) \\dots$ atomic polarizability\n",
    "\n",
    "dipole density\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{P}(t)=Nq\\Delta \\vec{r}(t), \\quad \\vec{P}=\\varepsilon_0\\chi\\vec{E} \\quad {\\rm (low~density)}\n",
    "\\end{equation}\n",
    "\n",
    "$\\chi$ is a complex number\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi=\\frac{Nq^2}{\\varepsilon_0 m}\\frac{1}{\\omega_0^2-i\\omega \\sigma -\\omega^2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi=\\chi_0\\frac{\\nu_0^2}{\\nu_0^2-\\nu^2-i\\nu \\Delta \\nu}, \\quad \\chi_0=\\frac{e^2 ??}{m \\varepsilon_0 \\omega_0^2}\n",
    "\\end{equation}\n",
    "\n",
    "quantum mechanical treatment\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi(\\omega)=\\frac{Ne^2}{\\varepsilon_0 m}\\sum_j \\frac{f_j}{\\omega_j^2-\\omega^2-i\\omega \\sigma_j}\n",
    "\\end{equation}\n",
    "\n",
    "oscillator strength\n",
    "\n",
    "\\begin{equation}\n",
    "f_{12}=\\frac 2 3 \\frac{m_l}{\\hbarÂ²} (E_2-E_1)\\sum_{\\alpha=x,y,z}|\\langle 1 | R_{\\alpha}|2 \\rangle|^2\n",
    "\\end{equation}\n",
    "\n",
    "assume the classical solution\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi=\\chi^\\prime+i\\chi^{\\prime\\prime}\n",
    "\\end{equation}\n",
    "\n",
    "$\\frac{1}{2 \\pi} \\omega_0 \\to \\nu_0, \\frac{1}{2 \\pi} \\sigma_j \\to \\Delta \\nu$\n",
    "\n",
    "real part\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi^\\prime=\\chi_0 \\frac{\\nu_0^2 (\\nu_0^2-\\nu^2)}{(\\nu_0^2-\\nu^2)^2+(\\nu \\Delta \\nu)^2}\n",
    "\\end{equation}\n",
    "\n",
    "imaginary part: Lorentz function\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi^{\\prime\\prime}=\\chi_0 \\frac{\\nu_0^2 \\nu \\Delta \\nu}{(\\nu_0^2-\\nu^2)^2+(\\nu \\Delta \\nu)^2}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{align}\n",
    "\\vec{k}=\\frac{\\omega}{c}&=\\omega \\sqrt{\\varepsilon \\mu_0}=k_0\\sqrt{1+\\chi}\\\\\n",
    "&=\\sqrt{1+\\chi^\\prime+i\\chi^{\\prime\\prime}}k_0=k_0(\\eta+i\\kappa)\n",
    "\\end{align}\n",
    "\n",
    "refractive index $n=\\eta+i\\kappa$\n",
    "\n",
    "\\begin{equation}\n",
    "n^2=\\varepsilon_r=(\\eta +i \\kappa)^2=1+\\chi\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\eta^2-\\kappa^2+2i\\eta\\kappa=1+\\chi^\\prime+i\\chi^{\\prime\\prime}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\eta^2-\\kappa^2=1+\\chi^\\prime\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "2 \\eta \\kappa =\\chi^{\\prime\\prime}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi^{\\prime\\prime}=\\varepsilon^{\\prime\\prime}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "e^{ikz}=e^{ik_0(\\eta+i\\kappa)z}=e^{ik_0\\eta z} e^{-k_0\\kappa z}\n",
    "\\end{equation}\n",
    "\n",
    "$e^{ik_0\\eta z} \\dots$ phase, $e^{-k_0\\kappa z} \\dots$ amplitude \n",
    "\n",
    "\\begin{equation}\n",
    "I=\\varepsilon_0 c \\bar{E^2}=\\varepsilon_0 c \\left| E_0 e^{ik_0\\eta z} e^{-k_0 \\kappa z} e^{-i\\omega t} \\right|^2\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I \\propto e^{-2k_0\\kappa z}=e^{-\\alpha z}\n",
    "\\end{equation}\n",
    "\n",
    "$2k_0\\kappa = \\alpha ~\\hat{=}$ absorption coefficient\n",
    "\n",
    "for weakly absorbing materials $\\chi^\\prime \\ll 1, \\chi^{\\prime\\prime} \\ll 1, n \\approx 1+\\frac{\\chi^\\prime}{2}, \\alpha \\approx -k_0 \\chi^{\\prime\\prime}$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### resonant medium\n",
    "\n",
    "atom in medium\n",
    "\n",
    "\\begin{equation}\n",
    "n(\\nu)\\approx n_0 + \\frac{\\chi^\\prime (\\nu)}{2 n_0}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\alpha (\\nu) \\approx -\\left(\\frac{2 \\pi \\nu}{n_0 c_0} \\right) \\chi^{\\prime\\prime}(\\nu)\n",
    "\\end{equation}\n",
    "\n",
    "$n_0 \\Rightarrow$ ??? medium"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### dispersion\n",
    "\n",
    "\\begin{equation}\n",
    "P(\\nu)=\\varepsilon_0 \\chi (\\nu)E(\\nu)\\quad \\hat{=} \\quad P(t)=\\varepsilon_0 \\int_{-\\infty}^t \\chi (t-t^\\prime) E(t^\\prime)\\mathrm dt\n",
    "\\end{equation}\n",
    "\n",
    "Dispersion is that $\\chi=\\chi(\\nu) \\quad \\Rightarrow \\quad n(\\nu)$\n",
    "\n",
    "measure is, for example, $\\frac{\\mathrm dn}{\\mathrm d \\lambda_0}$\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### absorption and dispersion\n",
    "\n",
    "- both effects are intimately related\n",
    "- origin in the Kramersâ€“Kronig relations\n",
    "\\begin{equation}\n",
    "\\chi^\\prime (\\nu)=\\frac{2}{\\pi}\\int_0^\\infty \\frac{s \\chi^{\\prime \\prime}(s)}{s^2-\\nu^2}\\mathrm ds\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi^{\\prime\\prime}(\\nu)=\\frac{2}{\\pi}\\int_0^\\infty \\frac{\\nu \\chi^{\\prime}(s)}{s^2-\\nu^2}\\mathrm ds\n",
    "\\end{equation}\n",
    "\n",
    "stems from the relation of $P(t)$ and $E(t)$\n",
    "\n",
    "$P(t)$ and $E(t)$ are real, thus $\\chi (-\\nu)=\\chi^*(\\nu)$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Kramersâ€“Kronig\n",
    "\n",
    "\\begin{equation}\n",
    "P(\\vec{r},t)=\\varepsilon_0\\int_{-\\infty}^{t} R(t-t^\\prime)\\vec{E}(\\vec{r},t^\\prime)\\mathrm dt^\\prime\n",
    "\\end{equation}\n",
    "or\n",
    "\\begin{equation}\n",
    "P(\\vec{r},t)=\\varepsilon_0\\int_0^\\infty R(\\tau) \\vec{E}(\\vec{r}, t-\\tau)\\mathrm d\\tau\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "R(\\tau)=\\frac{1}{2 \\pi}\\int_{-\\infty}^\\infty \\chi (\\omega) e^{-i\\omega t} \\mathrm d \\omega = \\frac{1}{2 \\pi}  \\int_{-\\infty}^\\infty\\chi^*(\\omega) e^{i \\omega t} \\mathrm d \\omega\n",
    "\\end{equation}\n",
    "\n",
    "with $\\chi(\\omega)=\\chi^*(\\omega)$\n",
    "\n",
    "\\begin{equation}\n",
    "R(\\tau)=\\theta (\\tau) y(\\tau)\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow F(R(\\tau))=F(\\theta(\\tau)y(\\tau))\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\chi(\\omega)=F(\\theta(\\tau)) * F(y(\\tau))\n",
    "\\end{equation}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.4 Polarization Optics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$\\vec{E}$ is a vector, the vector can change magnitude and direction in time and space.\n",
    "\n",
    "$\\Rightarrow$ direction is called polarization: linear polarizazition, circular\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{E}=Re \\left\\{\\vec{A} e^{i (\\omega t - kz)} \\right\\}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\vec{A}=A_x \\vec{e}_x+A_y \\vec{e}_y\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "A_x=a_x e^{i \\phi_x}, \\quad A_y=a_y e^{i \\phi_y}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "E_x=a_x \\cos \\left[\\omega t - kz + \\phi_x \\right]\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "E_y=a_y \\cos \\left[\\omega t - kz + \\phi_y \\right]\n",
    "\\end{equation}\n",
    "\n",
    "with $\\phi=\\phi_y-\\phi_x$\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow \\frac{E_x^2}{a_x^2}+\\frac{E_y^2}{a_y^2}-2\\cos\\phi\\frac{E_xE_y}{a_xa_y}=\\sin^2\\phi\n",
    "\\end{equation}\n",
    "\n",
    "This is an ??? equation\\\n",
    "half axis $a_x, a_y$\n",
    "\n",
    "orientation\n",
    "\n",
    "\\begin{equation}\n",
    "\\tan(2\\theta)=\\frac{2a_xa_y}{a_x^2-a_y^2}\\cos \\phi\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "I=\\frac{a_x^2+a_y^2}{2 \\eta}\n",
    "\\end{equation}\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### polarization states\n",
    "\n",
    "a) linear polarized light\n",
    "\n",
    "\\begin{equation}\n",
    "\\phi=\\phi_y-\\phi_x=0, \\pi\n",
    "\\end{equation}\n",
    "\n",
    "for $a_x=a_y ~ \\Rightarrow ~ 45^\\circ$, for example\n",
    "\n",
    "b) circular polarized light\n",
    "\n",
    "\\begin{equation}\n",
    "\\phi=\\phi_y-\\phi_x=\\pm \\frac \\pi 2, \\quad a_x=a_y=a_0\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\Rightarrow E_x^2+E_y^2=a_0^2\n",
    "\\end{equation}\n",
    "\n",
    "$\\phi=+\\frac \\pi 2$ right circular polarization\n",
    "\n",
    "$\\phi=-\\frac \\pi 2$ left circular polarization\n",
    "\n",
    "c) elliptical polarized light\n",
    "\n",
    "$\\phi$ different from the above cases and $a_x \\neq a_y$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Jones Formalism\n",
    "\n",
    "(matrix formalism for polarization)\n",
    "\n",
    "\\begin{equation}\n",
    "A_x=a_x e^{i \\phi_x}, \\quad A_y=a_y e^{i\\phi_y}\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "J=\\left[\\begin{array}{r}\n",
    "A_x \\\\\n",
    "A_y\n",
    "\\end{array}\\right]\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "(J_1, J_2)=A_{1x}A_{2x}^*+A_{1y}A_{2y}^*\n",
    "\\end{equation}\n",
    "\n",
    "\\begin{equation}\n",
    "\\frac{a_y}{a_x}=\\left|\\frac{A_y}{A_x} \\right| \\quad {\\rm and} \\quad \\phi=\\phi_y-\\phi_x\n",
    "\\end{equation}\n",
    "\n",
    "determine orientation and shape\n",
    "\n",
    "all normalized to $|A_x|^2+|A_y|^2=1, \\phi_x=0$\n",
    "\n",
    "linearly polarized light ($x$-direction)\n",
    "\\begin{equation}\n",
    "J=\\left[\\begin{array}{r}\n",
    "1 \\\\\n",
    "0\n",
    "\\end{array}\\right]\n",
    "\\end{equation}\n",
    "\n",
    "linear under angle $\\theta$ with $x$\n",
    "\\begin{equation}\n",
    "J=\\left[\\begin{array}{r}\n",
    "\\cos \\theta \\\\\n",
    "\\sin \\theta\n",
    "\\end{array}\\right]\n",
    "\\end{equation}\n",
    "\n",
    "right circular polarization\n",
    "\\begin{equation}\n",
    "J=\\frac{1}{\\sqrt{2}}\\left[\\begin{array}{r}\n",
    "1 \\\\\n",
    "j\n",
    "\\end{array}\\right]\n",
    "\\end{equation}\n",
    "\n",
    "left circular polarization\n",
    "\\begin{equation}\n",
    "J=\\frac{1}{\\sqrt{2}}\\left[\\begin{array}{r}\n",
    "1 \\\\\n",
    "-j\n",
    "\\end{array}\\right]\n",
    "\\end{equation}"
   ]
  }
 ],
 "metadata": {
  "@webio": {
   "lastCommId": null,
   "lastKernelId": null
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.16"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
